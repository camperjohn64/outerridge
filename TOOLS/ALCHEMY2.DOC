
          Targa
                     -a


                           Targa files were created to support the line of
                           Targa graphics cards.  The Targa format is popular
                           with scanners and high end paint packages.

          Syntax           -a outputType

          Parameter        outputType:
                                0:uncompressed
                                1:Run Length Coded
                                10:uncompressed, no footer
                                11:Run Length Coded, no footer
                           The default is 0 (uncompressed).

          Extension        .tga

          Creator          Truevision, Inc.

          Used by          Various scanning and paint software.

          Variations       Reads 8, 15, 16, 24, and 32 bit images, ignoring
                           the alpha channel for 32 bit images.

                           Writes 8, 15, 16, 24, and 32 bit images, writing
                           an empty alpha channel for 32 bit images.

          Comments         15 and 16 bit output are actually the same except
                           for one field in the header.

                           Targa files allow a footer containing additional
                           information such as aspect ratio.  However some
                           software is unable to read Targa files which have
                           a footer, so Alchemy allows all valid combinations
                           to be written.  The most common variant for
                           software to be able to read is 24 bit uncompressed
                           (specify -a0 and -24).

          Example          Convert the file input.tif to an uncompressed 24
                           bit Targa file:

                                alchemy input.tif -a -24

                           Convert the file input.tif to an uncompressed 15
                           bit Targa file called output.tga with no footer:

                                alchemy -a10 -15 input.tif output.tga






                                                   Image Alchemy          107




          Utah Raster Toolkit (RLE)                                --u


                           The Utah Raster Toolkit is a set of public domain
                           utilities for manipulating and converting images
                           for various workstations.  The source code is
                           freely available (see below).

          Syntax           --u

          Extension        .rle

          Creator          The University of Utah
                           The University of Michigan

          Used by          Utah RLE toolkit

          Variations       Reads and writes 1 and 3 channel 8 bits per pixel
                           files; the Alpha Channel is ignored during
                           reading.

          Limitations      While reading, files which are 1 channel and have
                           either no colour map or a single channel colour
                           map are assumed to be gray-scale images.  The
                           colour map, if present, will be used as a gamma
                           correction table.

                           Files which are 1 channel and have a 3 channel
                           colour map are assumed to be paletted colour
                           files.

                           Files which are 3 channel are assumed to be true
                           colour.

                           When writing RLE files Alchemy will generate a 1
                           channel file with a 3 channel colour map for
                           paletted images and a 3 channel file with no
                           colour map for true colour images.

          Comments         The Utah Raster Toolkit is available free of
                           charge as pub/urt-3.0.tar.Z via anonymous ftp from
                           cs.utah.edu, weedeater.math.yale.edu, or
                           freebie.engin.umich.edu or via floppy disk from
                           us.

          Example          Convert the PBM file, image.ppm, to a Utah RLE
                           file:

                                alchemy image.ppm --U





          108          Image Alchemy




          Vivid                                                    --I


                           Vivid is a shareware ray-tracer for MS-DOS
                           computers.

          Syntax           --I (upper case i)

          Extension        .img

          Creator          Steven B. Coy

          Used by          Vivid Ray Tracer

          Variations       Reads and writes 24 bit RLE files.

          Comments         The Vivid Ray Tracer is a shareware program for
                           PCs and is available from
                                Stephen Coy
                                15205 NE 13th Pl., #2904
                                Bellevue, WA  98007

          Example          Convert the file spheres.qrt to a Vivid file:

                                alchemy spheres.qrt --I





























                                                   Image Alchemy          109




          Windows Bitmap (BMP)                                      -w


                           Windows BMP files are used by Microsoft Windows.

          Syntax           -w compressionType

          Parameter        compressionType:
                                0:None
                                1:RLE
                                10:Write an ICOn file
                           The default is none.

          Extension        .bmp

          Creator          Microsoft Corp.

          Used by          Microsoft Windows

          Variations       Reads 1, 4, 8, and 24 bit RGB (raw), RLE4, and
                           RLE8 files.

                           Writes 1, 4, 8, and 24 bit RGB (raw), RLE4, and
                           RLE8 files.

          Limitations      Several of the programs which claim to read and
                           write RLE files do not do so correctly; we do not
                           recommend writing RLE files unless you have
                           verified that they work with your intended
                           application.

          Comments         Microsoft supplied Windows utilities cannot read
                           nor write RLE4 or RLE8 files.


                           If you are converting an image to use as wallpaper
                           on a 16 colour display you will want to match the
                           palette of the output image to one of the existing
                           16 colour BMP images supplied with Windows
                           (chess.bmp, for example).  If you do not do this
                           the wallpaper will not be loaded correctly.  See
                           the example section below.


                           If you are converting an image to use as wallpaper
                           on a 256 colour Windows 3.1 display you will want
                           to reserve the first 8 colours.  Use the -c 256 8
                           option to do this (see below for an example).
                           This will force the first 8 colours of the palette
                           to be the standard Windows colours.




          110          Image Alchemy




                           If you are writing a Windows icon (.ico) file you
                           must scale the image to a width and a height of
                           16, 32, or 64 pixels (32 being the best choice,
                           since Windows displays all icons as 32x32).  Also,
                           Windows seems to remap all icons to the standard
                           16 colours, so the best results can be obtained if
                           you match the palette of your icons to an existing
                           icon (see the -f option).  If you don't have any
                           other icons you can also match to one of the 16
                           colour wallpaper files supplied with Windows.


                           Alchemy can write a BMP file which contains an
                           identity palette as specified in the Microsoft
                           Multimedia Development Kit.  These images provide
                           for quicker bitmap loading when used with the
                           Multimedia Extensions.  A palette identity file
                           has the first and last 10 palette entries reserved
                           for 20 system defined colours.  Alchemy will write
                           such an image if you specify -c 246 10 as part of
                           the command line.  Note that ordinarily this would
                           produce a file which has 246 palette entries, but
                           in this special case the file will have 256
                           palette entries (20 fixed by the Windows
                           specifications and 236 chosen by Alchemy).  Note
                           that you can also specify a number smaller than
                           246, but the palette will always have 256 colours
                           (since the last 10 have to occupy positions 246
                           through 255).

          Related options  -c   Specify number of colours
                           -f   Match to existing palette

          Examples         Convert the image test.gif to a Windows BMP file:

                                alchemy test.gif -w

                           Convert the image test.gif to a 16 colour Windows
                           BMP file to be used as wallpaper (the file
                           chess.bmp is supplied with Windows 3.0 (substitute
                           leaves.bmp when using Windows 3.1); this example
                           assumes that it is in the current directory):

                                alchemy test.gif -f chess.bmp -w

                           Convert the image test.gif to a 256 colour Windows
                           BMP file to be used as wallpaper with Windows 3.1:

                                alchemy test.gif -c256 8 -w

                           Convert the image test.gif to an icon file for use
                           with Windows 3.1:


                                                   Image Alchemy          111




                                alchemy test.gif -Xb32 -Yb32 -w 10
                                   -f leaves.bmp

                           Convert the image test.gif to an identity palette
                           BMP file:

                                alchemy test.gif -w -c 246 10















































          112          Image Alchemy




          WordPerfect Graphic File                                  -W


                           WordPerfect files are images which can be imported
                           into WordPerfect and various other word processors
                           and desktop publishing programs.

          Syntax           -W

          Extension        .wpg

          Creator          WordPerfect Corp.

          Used by          WordPerfect

          Variations       1 through 8 bits per pixel are supported.

          Comments         In addition to raster images WordPerfect files may
                           contain vectors and text information.  Such
                           information is lost when reading WordPerfect
                           files.

          Example          Convert the image, newpict.pcx, to a black and
                           white WPG file:

                                alchemy newpict.pcx -b -c2 -W




























                                                   Image Alchemy          113




          XBM                                                      --b


                           XBM files are used by the X Windowing System.  XBM
                           files are C source code files which can be read
                           and written by various X utilities and are
                           designed to be included in C source code for use
                           as icons and other bit-mapped graphic images.

          Syntax           --b

          Extensions       .xbm
                           .bm

          Creator          MIT

          Used by          The X Windowing system

          Variations       1 bit per pixel

          Limitations      Because .xbm files are actually C source code
                           files there can be many variations of .xbm files.
                           Since adding a C preprocessor to Alchemy to handle
                           all the theoretically allowable .xbm files is
                           impractical we have instead designed Alchemy to
                           interchange .xbm files with the PBM utilities and
                           the X supplied utilities, and to read the sample
                           .xbm files from Sun Microsystems.  If you run
                           across any .xbm files which Alchemy cannot read
                           please contact us.

                           The hotspot field is ignored when reading .xbm
                           files.

          Comments         Most of the X supplied utilities (bitmap, for
                           example) are designed to edit small .xbm images.



          Example          Convert the file picture.im32 to an XBM file using
                           high quality scaling and preserving the aspect
                           ratio:

                                alchemy --b -Xb64 -+ picture.im32










          114          Image Alchemy




          XPM                                                      --x


                           XPM files are used by the X Windowing System.  XPM
                           files are C source code files which can be read
                           and written by various X utilities and are
                           designed to be included in C source code for use
                           as icons and other bit-mapped graphic images.

          Syntax           --x type

          Parameter        type:
                                0:  XBM similar style
                                1:  XPM3 style
                                2:  XPM2 style
                           The default is XBM similar style.

          Extensions       .xpm
                           .pm

          Creator          MIT

          Used by          The X Windowing system

          Variations       8 bits per pixel

          Limitations      Because .xpm files are actually C source code
                           files there can be many variations of .xpm files.
                           Since adding a C preprocessor to Alchemy to handle
                           all the theoretically allowable .xpm files is
                           impractical we have instead designed Alchemy to
                           interchange .xpm files with the PBM utilities and
                           the X supplied utilities, and to read the sample
                           .xpm files from IBM.  If you run across any .xpm
                           files which Alchemy cannot read please contact us.

                           Some XPM files contain colour names instead of
                           color values for some of the colours.  The
                           conversion table of these names into values is in
                           a file supplied with the X Windowing system called
                           rgb.txt.  When needed Alchemy will look for this
                           table in the following directories:  the current
                           directory, /usr/lib/X11, $OPENWINHOME, and
                           /usr/openwin/lib.  If your system has the rgb.txt
                           file in a different location you may have to copy
                           it to the current directory (its location is
                           system dependent; ask you system administrator if
                           you need help finding it).






                                                   Image Alchemy          115




          Comments         The different type XPM files can be identified as
                           follows:

                           Type 0:
                                #define type0_format 1
                                _
                                static char *type0_colors[] = {
                                "a", "#000000",
                                _

                           Type 1:
                                /* XPM */
                                static char * type1[] = {
                                "32 20 12 1",
                                "a c #000000",
                                _

                           Type 2:
                                ! XPM2
                                32 20 12 1
                                a c #000000
                                _

                           When writing an XPM file with less than 27 colours
                           Alchemy writes 1 character XPM files, otherwise
                           Alchemy writes 2 character XPM files.

                           XPM files are usually quite small, therefore many
                           utilities (the PBM toolkit for example) may have
                           trouble reading large XPM files.

          Example          Convert the file picture.im32 to an XPM file using
                           high quality scaling and preserving the aspect
                           ratio:

                                alchemy --x -Xb64 -+ picture.im32


















          116          Image Alchemy




          XWD                                                      --w


                           XWD is the file format used by xwd, the X window
                           dumping utility.

          Syntax           --w type

          Parameter        type:
                                0:  Z type
                                1:  XY type
                           The default is Z type.

          Extension        .xwd

          Creator          MIT

          Used by          The X Windowing System

          Variations       Reads 1, 4, 8, and 24 bits per pixel Z format and
                           1, 4, and 8 bit XY format XWD files.

                           Writes 1, 8, and 24 bits per pixel Z format and 1
                           and 8 bit XY format XWD files.

          Limitations      XY format files are not supported.

          Example          Convert the XBM file, icon.xbm, to an XWD file:

                                alchemy icon.xbm --w
























                                                   Image Alchemy          117




                                                                            5



          General Options
          -------------------------------------------------------------------


          Introduction     General options are options which do not affect
                           the conversion of the image.  They control such
                           things as the overwriting of existing files and
                           the way that memory is used.

                           If you are currently using the Alchemy's menu
                           interface rather than the command-line, you can
                           focus on the purpose, comments, and limitations
                           entries in this chapter.





































          118          Image Alchemy




          Conserve Memory                                           -$


          Purpose          Use as little memory as possible when converting
                           images.

          Syntax           -$ (dollar sign)

          Comments         Normally Alchemy tries to work on chunks of the
                           image several lines long to improve performance.
                           Use of the -$ option will cause it to use the
                           smallest size chunks possible for the conversion
                           being performed.  On MS-DOS based systems this
                           will usually allow conversion of larger images
                           than would otherwise be possible.  On UNIX systems
                           this may reduce paging when converting very large
                           images.

          Example          Convert the image giant.tga to a 16 colour TIFF
                           file conserving memory:

                                alchemy giant.tga -$ -t -c16
































                                                   Image Alchemy          119




          Display Image Stats                                       -x


          Purpose          Display image statistics.

          Syntax           -x

          Comments         Displays image type, size, number of colours,
                           aspect ratio, resolution, and compression ratio.

          Limitations      Cannot be combined with other options.

          Example          Find out about the image called image.tga:

                                alchemy -x image.tga







































          120          Image Alchemy




          Do not alter output filename                              -.


          Purpose          Disable automatic appending of the output image
                           type to the output file name.

          Syntax           -. (period)

          Comments         By default, if there's no '.' in the output
                           filename, Alchemy will add an extension indicating
                           the type of file.  If the -. option is specified
                           no extension will be added.

                           This is most useful on non-MS-DOS systems where
                           '.' is not a special character in filenames.

          Example          Convert the file called infile.gif to a PCX file
                           called outfile (if you did not use the -. option
                           Alchemy would automatically change the output file
                           name to outfile.pcx):

                                alchemy infile.gif outfile -p -.
































                                                   Image Alchemy          121




          Help                                                      -h


          Purpose          Give you information on how to use Image Alchemy.

          Syntax           -h option

          Parameter        option
                                0: general help
                                1: general options
                                2: output formats a-k
                                3: output formats l-z
                                4: colour options
                                5: scaling options
                                6: display options (MS-DOS Only)
                           Default is 0, general help

          Comments         The help information given by this command is only
                           a summary.

          Limitations      The help option cannot be combined with any other
                           options.

          Related options  -?   support and update information

          Example          Get help on the colour options:

                                alchemy -h4


























          122          Image Alchemy




          Overwrite                                                 -o


          Purpose          Force Alchemy to overwrite existing files on the
                           disk.

          Syntax           -o

          Comments         Image Alchemy will not overwrite an existing file
                           unless the -o option is specified.

          Limitations      The input file name and the output file name
                           cannot be the same.

          Example          Convert the file input.tga to a GIF file called
                           output.gif, overwriting the existing file called
                           output.gif:

                                alchemy input.tga -g output.gif -o



































                                                   Image Alchemy          123




          Program information                                       -?


          Purpose          Give you information on how to get support for
                           Image Alchemy or inquire about update information.

          Syntax           -?

          Comments         Sun-3 and Sun-4 users have to escape the question
                           mark with a back-slash (instead of -? use -\?).
                           This is because the UNIX shell will attempt to
                           perform wildcard expansion on the question mark.

          Limitations      The information option cannot be combined with any
                           other options.

          Related options  -h   help with commands

          Example          Get support information:

                                alchemy -?

































          124          Image Alchemy




          Quiet                                                     -Q


          Purpose          Suppress all status messages (but not error
                           messages).

          Syntax           -Q

          Comments         This is useful when running Alchemy in the
                           background on UNIX systems or in batch files on
                           MS-DOS systems (and you don't want the output of
                           Alchemy scrolling important messages off of the
                           screen).

          Limitations      There is no way to suppress error messages.

          Example          Convert the file dummy.gif to a PCX file but don't
                           report any status messages:

                                alchemy -Q dummy.gif -p


































                                                   Image Alchemy          125




          Warnings                                                 --W


          Purpose          Treat missing input files, unidentifiable input
                           files, and non-overwriteable output files as a
                           non-fatal errors.

          Syntax           --W

          Comments         When used in conjunction with the Wildcard option
                           (see below) the Warnings option allows Alchemy to
                           proceed even when certain error conditions occur.
                           Specifically, any input files which are missing or
                           can't be identified as valid image files, and any
                           output files which already exist but are not to be
                           overwritten, are skipped and processing continues
                           with the next file.

                           At the end of processing Alchemy displays lists of
                           the files which were not found, which could not be
                           identified, and which already existed but could
                           not be overwritten.

                           This option was added at the request of our
                           customers who routinely convert large numbers of
                           files and don't want Alchemy to stop if it finds a
                           file missing or finds that an output file already
                           exists.

          Limitations      Any errors which occur during the processing of an
                           image file are always fatal.

                           This option can only be used with the Wildcard
                           option.


          Examples         Convert all the GIF files in the current directory
                           to JPEG files, skipping any files which can't be
                           identified or already have existing JPEG files:

                                alchemy -- *.gif -j --W













          126          Image Alchemy




          Wildcard                                                  --


          Purpose          Allow the conversion of multiple files with a
                           single execution of Alchemy.

          Syntax           -- (dash)

          Comments         The wildcard option allows you to specify multiple
                           file names and file names which include wild card
                           characters.  Alchemy will perform the same
                           conversion for each input file name that it finds.


                           On MS-DOS systems the use of the wildcard option
                           (--) is not required if the first file name
                           specified includes a wildcard character (* or ?);
                           however to reduce confusion it is still
                           recommended.

          Limitations      The wildcard option (--) must be specified before
                           any file names.


                           If you are using the wildcard option you may not
                           specify an output file name;  the file names are
                           automatically generated by substituting an
                           appropriate extension to the input file names.  If
                           you do specify an output file name it will be
                           misinterpreted as another input file.  An output
                           path name may still be specified.


                           Any error will terminate the execution of Alchemy;
                           any images which appear in the filename list after
                           the one causing the error will not be processed.
                           This includes attempting to overwrite an already
                           existing file without specifying the -o option.


                           Alchemy does not intelligently retain information
                           between files.  For example, if you are matching a
                           group of files to an existing palette, the inverse
                           palette generation step only needs to be performed
                           once, but it is in fact done for each file.  This
                           only affects the speed of conversions, not the
                           quality.


          Examples         Convert all the GIF files in the current directory
                           to JPEG files:



                                                   Image Alchemy          127




                                alchemy  --  *.gif  -j

                           Convert all the TIFF files in the directory \tiff
                           to PCX files in the directory \images\output:

                                alchemy  --  \tiff\*.tif -p \images\output

                           Convert the files madonna.gif, bay4.gif,
                           everest.tga, and basil.tif to JPEG files,
                           overwriting any existing files:

                                alchemy  --  -o madonna.gif bay4.gif -j
                                everest.tga basil.tif

                           Convert the files test1.tif, test2.tif, and
                           new*.gif to ILBM files, matching them to the
                           palette from the file output.pal:

                                alchemy  --  test1.tif test2.tif new*.gif -f
                                output.pal -i


































          128          Image Alchemy




                                                                            6



          Colour and Palette Options
          -------------------------------------------------------------------


          Introduction     Colour and Palette options are options which
                           affect the appearance of the output image.  They
                           control such things as the number of colours in
                           the output image and the dithering techniques
                           used.

                           If you are currently using the Alchemy's menu
                           interface rather than the command-line, you can
                           focus on the purpose, comments, and limitations
                           entries in this chapter.




































                                                   Image Alchemy          129




          Black and White                                           -b


          Purpose          Convert the image to black and white.

          Syntax           -b

          Comments         The -b and -c options used in conjunction
                           specifies the number of shades of gray in the
                           image.  The default is 256 shades of gray when
                           converting from a true colour image.  When
                           converting from a paletted image the number of
                           shades of gray defaults to the number of colours
                           in the original image.

                           The shades of gray are uniformly distributed from
                           0 to 255.

                           When converting from true colour the image will be
                           changed to a paletted image unless the -24 option
                           is used.

          Related options  -8   Paletted output
                           -24  True colour output
                           -c   Specify number of colours

          Examples         Convert the file sample.jpg into a 256 shades of
                           gray raw file:

                                alchemy sample.jpg -b -r

                           Convert the file madonna.jpg into a 4 shades of
                           gray gif file called gray.gif:

                                alchemy -b -c4 -g madonna.gif gray.gif



















          130          Image Alchemy




          Colours                                                   -c


          Purpose          Specify the number of colours for the output file.

          Syntax           -c colours [reserveColours]

          Parameters       colours
                                Specifies the number of colours in the output
                           image.  May be between 2 and 256.

                           reserveColours
                                Specifies the number of colours to reserve in
                           the output image.  May be between 0 and 255.

          Comments         If the input file has a larger number of colours
                           than specified for the output file, the image will
                           be quantized using Heckbert's median cut algorithm
                           and dithered.  For further information on
                           Heckbert's median cut algorithm see Appendix B,
                           Colour and Dithering.

                           The number of colours to reserve is an optional
                           parameter.  If it is present it causes the
                           specified number of colours to be reserved from
                           the beginning of the palette.  The output image
                           will not contain any of those colour indices.
                           This can be useful if you have menus or other
                           information you wish to display at the same time
                           as the images and they use colours at the
                           beginning of the palette.  The menu colours will
                           then not interfere with the image.  The first
                           indices are set to black unless 16 is specified,
                           in which case they are set to the standard VGA
                           colour palette.

          Limitations      Specifying the number of colours only has an
                           effect if you are writing a paletted file (using
                           the -8 option) or if the output file type is
                           always paletted.

                           Converting an image with a large number of colours
                           to a small number of colours (less than 8) will
                           usually give poor results.

                           The reserved colours will be set to black unless
                           16 colours are reserved.  In that case they will
                           be set to the standard VGA colours.

          Related options  -8   Convert to paletted image
                           -d   Specify dither type
                           -u   Use uniform palette


                                                   Image Alchemy          131




          Examples         Convert the image colours.gif into a 16 colour PCX
                           file called colour16.pcx

                                alchemy colours.gif -p -c16 colour16.pcx

                           Convert the image colours.tga into a 256 colour
                           GIF file called output.gif, reserving the first 16
                           colours.

                                alchemy colours.tga -g -c256 16 output.gif












































          132          Image Alchemy




          Dither                                                    -d


          Purpose          Specifies the type of dithering to apply to the
                           image.

          Syntax           -d[s] ditherType [perturbation]

          Parameters       If the -d is immediately followed by an 's', then
                           a serpentine raster is used.

                           ditherType can be:
                                0:None
                                1:Floyd-Steinberg
                                2:Stucki
                                3:Jarvis, Judice, & Ninke
                                4:Stevenson and Arce
                                5:Sierra Lite
                                20:Halftone (clustered dot)
                                21:Bayer (dispersed dot)
                                22:Halftone 2 (clustered dot)
                           The default is Floyd-Steinberg.

                           perturbation
                                0 through 127
                           The default is 0.

          Comments         Dithering is used to reduce colour banding in an
                           image caused by the palette not having a perfect
                           match for every colour in the image.


                           Types 1 through 5 are all error-diffusion dithers.
                           Types 1 and 5 are the fastest of the diffusion
                           dithers, and they usually look the best on low
                           resolution devices like CRTs.  Types 2, 3, and 4
                           all tend to cause an image to appear more grainy
                           on low resolution output devices (such as CRTs).
                           However, they produce better results than types 1
                           or 5 on high-resolution, low colour output devices
                           such as laser printers.


                           Type 20 is a digital halftone; this will produce
                           the most accurate grays on a laser printer, but
                           the image won't be as sharp as one produced by the
                           error-diffusion dithers.  Type 21 is a dispersed
                           dot ordered dither; it's only advantage over the
                           error-diffusion algorithms is speed.  Type 22 is
                           an additional halftone pattern.  It's similar to
                           type 20, but with a finer screen.



                                                   Image Alchemy          133





                           The -d option only has an effect if the number of
                           colours is being reduced or the image is being re-
                           mapped to a new palette.


                           Specifying a perturbation adds noise to the image,
                           which can help break up visible patterns
                           introduced by dithering.  The parameter specifies
                           the magnitude of the noise.  Perturbation has no
                           effect on dither types 20, 21, and 22.

                           Using a serpentine raster can also help to reduce
                           visible patterns introduced by dithering.  Using a
                           serpentine raster has no effect on dither types
                           20, 21, and 22.

          Examples         Convert the 256 colour file image.gif to a 16
                           colour PCX file using a uniform palette and no
                           dithering:

                                alchemy image.gif -p -c16 -d0 -u


                           Convert the true colour image sample.jpg into a
                           256 colour GIF file called sample.gif, using
                           Stucki dithering:

                                alchemy -g -d2 sample.jpg


                           Convert the 256 colour image sample.gif into a one
                           bit black and white PCL file called sample.pcl,
                           using Jarvis, Judice, and Ninke dithering, a
                           serpentine raster, and a little noise:

                                alchemy -P -b -c2 -ds3 20 sample.gif

















          134          Image Alchemy




          EGA Palette                                               -E


          Purpose          Optimize the image quality for display on an EGA
                           board and monitor.

          Syntax           -E

          Comments         If you are converting images to display on an EGA
                           board and monitor this option will optimize the
                           image quality.

                           This option reduces the palette resolution to two
                           bits and automatically specifies the following:
                           -8 -c16 -z0 2 0.

          Limitations      The number of colours in an EGA palette must be
                           less than or equal to 16;  the number of colours
                           defaults to 16 but can be reduced by using the -c
                           option.

          Related options  -c   specify number of colours

          Example          Convert the image dave1.tga into dave1.pcx, a PCX
                           file with a palette optimized for EGA use:

                                alchemy -E -p dave1.tga



























                                                   Image Alchemy          135




          False Colour                                              -F


          Purpose          False colour an image using the palette from a
                           file.  The input image will be changed to use the
                           palette found in the specified filename but no
                           attempt at picking the best match will be done.

          Syntax           -F filename

          Parameter        filename
                                Any valid image type which contains a palette

          Comments         This feature can be used to add false colour to
                           monochrome images.  The output file is not
                           dithered.  This is only applicable to paletted
                           input files.

          Limitations      Cannot be combined with spiff -S or match to
                           palette -f.

          Example          False colour the file scan.gif using the palette
                           from the file colorful.pcx, creating the GIF file
                           new.gif:

                                alchemy -F colorful.pcx -g scan.gif new.gif




























          136          Image Alchemy




          Gamma correction                                          -G


          Purpose          Specify the gamma of an input, output, or palette
                           file and/or perform gamma correction.

          Syntax           -G gammaType gammaValue

          Parameters       gammaType:
                                i:Specify input gamma
                                o:Specify output gamma
                                p:Specify gamma of palette

                           gammaValue:
                                0.0 to 4.0

          Comments         To perform gamma correction, Alchemy needs to know
                           both the input and output gamma.  For some file
                           formats the gamma is known; if you're reading a
                           file with known gamma, such as JPEG, PICT,
                           PCPAINT, or a Targa file with the gamma field, you
                           don't need to specify the input gamma.  Likewise,
                           if you're writing a file which has a fixed gamma
                           you don't need to specify an output gamma.  Even
                           if reading or writing a file format which has a
                           known gamma you may override it by using the -Gi
                           or -Go option.


                           However, even if both input and output gamma are
                           known based on the input file and the output
                           format, you must still enable gamma correction for
                           any correction to take place; you can do this with
                           just '-G' (if you had specified input, output, or
                           palette gamma, this would be implied).  This is
                           because there are quite a few images around that
                           have specified or implied gammas that are wrong,
                           which could cause Alchemy to make matters worse
                           instead of better.


                           Typical values for gamma are 1.0 for images from
                           Macintoshes and 2.2 for images from PCs.

          Examples         To convert the Mac PICT file test.pic, which has a
                           gamma of 1.0, to a PCX file for use on a PC (which
                           should have a gamma of 2.2), use:

                                alchemy -p -Gi1.0 -Go2.2 test.pic





                                                   Image Alchemy          137




                           The input gamma could have been omitted, as PICT
                           files have an implied gamma of 1.0, but it's best
                           to include it to reduce confusion.

                           To convert the file image.tga, which has a gamma
                           of 2.2, to a GIF file for use on a Mac, matching
                           the palette test.pal which was created with a
                           gamma of 1.5:

                                alchemy image.tga -g -Gi2.2 -Go1.0 -Gp1.5 -
                                ftest.pal











































          138          Image Alchemy




          Match Palette                                             -f


          Purpose          Match the output to a palette read from a file.
                           The input image will be re-mapped to use the
                           palette found in the specified file.

          Syntax           -f filename

          Parameter        filename
                                Any valid image type which contains a palette

          Comments         Using the -f option will cause the output image to
                           be dithered (unless you specify no dithering by
                           using the -d0 option).

                           The -f option can be useful if you are combining
                           several images into a collage or want to match an
                           image to a pre-existing palette.  You can also
                           create a custom palette from scratch by using a
                           text editor and creating a .PAL file.

          Limitations      Cannot be combined with spiff -S or false colour -
                           F.

                           The number of colours in the final image will be
                           equal to the number of colours in the palette
                           being read in.

                           The specified file must contain a palette (i.e.
                           cannot be true colour).

          Related options  -l   Generate palette file
                           -F   False colour
                           -d   Dither



          Examples         Convert the image bigimage.tif to a pcx file using
                           the palette from the file standard.pal:

                                alchemy bigimage.tif -p -f standard.pal

                           Convert the image colour.gif to a gif file called
                           colour2.gif using the palette from the file
                           newpal.gif:

                                alchemy -fnewpal.gif -g colour.gif colour2






                                                   Image Alchemy          139




          Negate                                                    -N


          Purpose          Changes the image to a negative.

          Syntax           -N

          Comments         This is equivalent to a photographic negative.
                           When used on black and white images black is
                           changed to white and white is changed to black.
                           On colour images each of the Red, Green, and Blue
                           channels are inverted separately (so that bright
                           blue will become bright yellow).

          Examples         Negate the file sample.gif, generating a GIF file
                           called negative.gif:

                                alchemy sample.gif -N -g negative




































          140          Image Alchemy




          Palette                                                   -8


          Purpose          Force the output image to be paletted.

          Syntax           -8

          Comments         This option is -8 because paletted images are
                           typically 8 bits per pixel.

                           Alchemy defaults to the -8 option if the input
                           file is paletted or gray-scale.

                           Some file formats require files to be paletted;
                           for those formats the -8 option is assumed.  Some
                           file formats do not have a paletted variation; in
                           those cases the -8 option will be ignored if
                           specified.  Some file formats only allow gray-
                           scale files to be 8 bit; in those cases Alchemy
                           will ignore the -8 option if the image being
                           written is not gray-scale.

                           The actual number of bits per pixel is determined
                           by the -c option (below).

                           If the input file is true colour the output file
                           will be quantized and dithered (see the -c and -d
                           options below).

          Related options  -15  True colour output
                           -16  True colour output
                           -24  True colour output
                           -32  True colour output
                           -c   specify number of colours in image
                           -d   dither

          Examples         Convert the JPEG file bigimage.jpg into a paletted
                           TIFF file with 256 colours:

                                alchemy -8 -t bigimage.jpg

                           Convert the Targa file madonna.tga to a 16 colour
                           PCX file (note that the -8 option is implied by
                           the use of the    -c16 option):

                                alchemy -c16 -p madonna.tga








                                                   Image Alchemy          141




          Palette Selection                                         -z


          Purpose          Control how the palette is generated.  These
                           options only have an effect if the palette is
                           being generated by Alchemy using Heckbert's median
                           cut algorithm.

          Syntax           -z sortType [selectionType [swapType] ]


          Parameters       Sort the image palette.  SortType can be:
                                0:None
                                1:popularity
                                2:luminance (white to black)
                                3:rgb
                                4:luminance (black to white)
                           The default is None.


                           SelectionType can be:
                                0:mean
                                1:median
                                2:corner
                           The default is mean.


                           See Appendix B, Colour and Dithering, for an
                           explanation of these choices.


                           SwapType can be:
                                0:None
                                1:IBM (colour 0 is black, 7 is white)
                                2:Macintosh (colour 0 is white, 255 is black)
                                3:Sun (colour 0 is white, 1 is black)
                           The default is based on the file type being
                           written out (IBM for GIF, Macintosh for Mac PICT,
                           Sun for Sun Raster, and None for all others).















          142          Image Alchemy




          Comments         The most common use for this option is to sort the
                           palette; in this case only a single parameter is
                           needed.

                           This option only affects palettes that are
                           generated by Alchemy.  To sort an existing palette
                           you can save the image as a true colour file (such
                           as HSI Raw, by using the -24 -r options) and then
                           convert that back to a paletted file, specifying
                           the desired sort type.  In most cases this will
                           not change the image (other than the palette
                           order); however if the palette had entries
                           representing colours that are nearly identical
                           then the image may be modified.

          Limitations      Note that it is not possible to specify a swapType
                           without first specifying both a sortType and a
                           selectionType.  See Appendix B, Colour and
                           Dithering, for more information.

          Example          Convert the file input.tga to a gif filed called
                           output.gif sorting the colours by luminance, using
                           the mean of the Heckbert box for the colour, and
                           moving the colours around so that the lightest
                           colour is colour 0 and the darkest colour is
                           colour 1.

                                alchemy input.tga -g output.gif -z4 0 3


























                                                   Image Alchemy          143




          Spiff                                                     -S


          Purpose          Enhance the image contrast by stretching the pixel
                           colour values to the full 0 to 255 range.

          Syntax           -S spiffType

          Parameter        spiffType:
                                a:histogram stretching
                                b:histogram linearization
                                c:histogram stretching with b/w ignored
                           The default is histogram stretching.

          Comments         This command can be used if the image you are
                           converting is shifted in brightness or squished in
                           contrast.  This can happen if you scan or digitize
                           a very dark or very bright image.

                           The default type, histogram stretching, simply
                           insures that the image has pixels which are
                           distributed over the entire output range (0 to
                           255).

                           Histogram linearization insures that the
                           distribution of pixels over the output range is
                           linear.

                           Type C spiffing is identical to histogram
                           stretching except that the colours absolute black
                           and absolute white are ignored in the image.  This
                           is useful when you have images which have black
                           borders or white captions, since type A spiffing
                           would treat these as part of the image data and
                           not perform any spiffing.

                           Histogram linearization can produce significantly
                           better results than histogram stretching for some
                           images.  Generally you will want to try both types
                           to see which gives better results.

          Limitations      The -S option cannot be used at the same time as
                           the -b option when converting from a true colour
                           image.  A work around is to do the operation in
                           two steps, converting it to black and white first
                           and then spiffing the resulting image.








          144          Image Alchemy




                           Using the spiff option at the same time as the
                           match palette, -f, or false colour, -F, options is
                           not allowed.  This is because the spiff option
                           would be performed before the palette is changed,
                           which would nullify the effects.  A work around is
                           to do the matching or false colouring first, and
                           then spiff the resultant image.


          Related options  -b   Black and White
                           -f   Match palette
                           -F   False colour image

          Example          Convert the file gloomy.pcx into a PCX file called
                           better.pcx:

                                alchemy gloomy.pcx -S -p better.pcx

                           Do the same thing using histogram linearization
                           instead of histogram stretching:

                                alchemy gloomy.pcx -Sb -p better.pcx
































                                                   Image Alchemy          145




          True Colour (15 bits)                                    -15


          Purpose          Force the output image to be true colour, 15 bits
                           (5 bits per component).

          Syntax           -15

          Comments         See the True Colour (24 bits) section, below.

          Related options  -8   Paletted output
                           -16  True colour output
                           -24  True colour output
                           -32  True colour output

          Example          Convert the GIF file test.gif into an
                           uncompressed, true colour 15 bit Targa file called
                           test.tga:

                                alchemy test.gif -a0 -15


































          146          Image Alchemy




          True Colour (16 bits)                                    -16


          Purpose          Force the output image to be true colour, 16 bits
                           (5 bits each for red and blue, 6 for green).

          Syntax           -16

          Comments         See the True Colour (24 bits) section, below.

          Related options  -8   Paletted output
                           -15  True colour output
                           -24  True colour output
                           -32  True colour output

          Example          Convert the GIF file test.gif into an
                           uncompressed, true colour 16 bit Targa file called
                           test.tga:

                                alchemy test.gif -a0 -16


































                                                   Image Alchemy          147




          True Colour (24 bits)                                    -24


          Purpose          Force the output image to be true colour (not
                           paletted).

          Syntax           -24

          Comments         This option is -24 because true colour images are
                           typically 24 bits per pixel.

                           Some file formats require files to be true colour;
                           for those formats the -24 option is assumed.  Some
                           file formats only have a paletted variation; in
                           those cases the -24 option will be ignored if
                           specified.

                           The file formats which may be either true colour
                           or paletted default to true colour if the input
                           file is true colour.

                           Certain file formats may only be paletted if the
                           images are gray-scale, in those cases Alchemy will
                           automatically switch to true colour if the output
                           image is colour.

                           Converting a paletted image to true colour will
                           not improve its quality or change its appearance.
                           The primary use of this option is to force an
                           image to be true colour when converting to a
                           format which allows either paletted or true
                           colour, but where the paletted variation is not
                           well supported (like the Targa image format).

          Related options  -8   Paletted output

          Example          Convert the GIF file test.gif into an
                           uncompressed, true colour Targa file called
                           test.tga:

                                alchemy test.gif -a0 -24













          148          Image Alchemy




          True Colour (32 bits)                                    -32


          Purpose          Force the output image to be true colour, 32 bits
                           (8 bits per component, 8 bits for alpha).

          Syntax           -32

          Comments         See the True Colour (24 bits) section, above.

          Related options  -8   Paletted output
                           -15  True colour output
                           -16  True colour output
                           -24  True colour output

          Example          Convert the GIF file test.gif into an
                           uncompressed, true colour 32 bit Targa file called
                           test.tga (the alpha channel will be empty):

                                alchemy test.gif -a0 -32


































                                                   Image Alchemy          149




          Undercolour Removal                                       -C


          Purpose          Control the undercolour removal process, colour
                           correction, and density correction for output
                           formats which use the CMYK colour space.

          Syntax           -C filename

          Parameter        filename
                                The name of the file which contains the
                           undercolour removal information

          Comments         The undercolour removal portion of the file is
                           compatible with the format used by Stork
                           Colorproofing B.V.  The format of this file is
                           described in Appendix G, Undercolour Removal
                           Files.

                           Sample undercolour removal files can be found in
                           the samples directory on the Alchemy distribution
                           disk or tape.

          Example          Convert the file image.tga to an HP RTL file
                           called image.rtl using the undercolour removal
                           file sample.ucr:

                                alchemy image.tga --r4 -Csample.ucr


























          150          Image Alchemy




          Uniform Palette                                           -u


          Purpose          Use a Uniform Palette.

          Syntax           -u

          Comments         Instead of using the Heckbert median cut algorithm
                           to generate a custom palette for the image, use a
                           palette with entries which are evenly distributed
                           in the RGB colour cube.

                           The advantage of using a uniform palette is that
                           it's faster than generating a custom palette.
                           However, this is at the expense of image quality
                           since the palette isn't generated based on image
                           content.

                           When just viewing a true colour image on a
                           paletted display a uniform palette is used.

                           The -c option can be used in conjunction with -u
                           to specify the size of the uniform palette; in
                           that case Alchemy will generate a palette with not
                           more than the specified number of colours (but not
                           less than 8).

          Limitations      The palette size will not necessarily match the
                           specified size, as the actual size must be the
                           product of three integers.  Alchemy picks integers
                           that roughly correspond to the sensitivity of the
                           human eye to red, green, and blue (30%, 59%, and
                           11%).

          Related options  -c   Specify number of colours
                           -d   Dither type

          Examples         Convert the file many.tga to a gif file using a
                           256 colour uniform palette:

                                alchemy many.tga -g -u

                           Convert the file many.tga to a gif file with up to
                           128 colours in a uniform palette:

                                alchemy many.tga -g -u -c128








                                                   Image Alchemy          151




                                                                            7



          Scaling Options
          -------------------------------------------------------------------


          Introduction     These options are all related to image scaling.
                           Note that the -D option does not actually change
                           the size of the image, it specifies an aspect
                           ratio or image resolution to be placed in the
                           header of the output image.

                           If you are using the GUI, you can concentrate on
                           the comments and limitations sections, and ignore
                           the others.





































          152          Image Alchemy




          Flip Image                                                -^


          Purpose          Flip image vertically (turn image upside-down)

          Syntax           -^

          Comments         Causes the image to be turned upside-down.

          Examples         Convert the Targa file head.tga to another Targa
                           file called tail.tga:

                                alchemy head.tga tail.tga -a -^









































                                                   Image Alchemy          153




          Preserve Aspect Ratio                                     -+


          Purpose          Preserve aspect ratio when scaling.

          Syntax           -+ (plus)

          Comments         If specified with either the -X or -Y option
                           Alchemy will choose the other dimension to
                           preserve the aspect ratio of the image.

                           If specified in conjunction with both -X and -Y
                           Alchemy will use the values specified as a
                           bounding box, reducing one dimension if necessary
                           to preserve the image aspect ratio.

          Limitations      Does not pay attention to the pixel aspect ratio
                           values in the input image.

          Related options  -X   Scale image in horizontal dimension
                           -Y   Scale image in vertical dimension

          Examples         Change the size of the image toobig.gif so that
                           the width is 640 and the height is the correct
                           number to preserve the aspect ratio of the image
                           (the new image will be called notbig.gif):

                                alchemy -X640 -+ toobig.gif -g notbig

                           Do the same thing but guarantee that the image
                           will not be larger than 640 by 480:

                                alchemy -X640 -Y480 -+ toobig.gif -g notbig


                           Do the same thing but use better quality scaling:

                                alchemy -Xb640 -Yb480 -+ toobig.gif -g notbig
















          154          Image Alchemy




          Scale Image in Horizontal Direction                       -X


          Purpose          Scale the horizontal dimension of the image to the
                           specified number of pixels.

          Syntax           -X[scaleType] pixels

          Parameters       scaleType
                                The type of scaling to use:
                                   a: nearest neighbor
                                   b: averaging/linear interpolation
                                   c: lanczos2
                                   d: lanczos3
                                scaleType is optional; the default is nearest
                           neighbor.  The higher the scale type the higher
                           the quality (and the longer the processing time).

                           pixels
                                The number of pixels in the output image in
                           the horizontal dimension.

          Comments         Nearest neighbor type scaling is faster than the
                           other types but introduces aliasing (which reduces
                           image quality).  The highest quality scaling
                           supported is lanczos3, but it takes much longer
                           than averaging/linear interpolation and generally
                           doesn't produce significantly better results.

          Limitations      All of the scale types other than nearest neighbor
                           give much better results than nearest neighbor
                           scaling, but they are slower and require a new
                           palette to be generated for paletted output files
                           (you can force alchemy to use the original palette
                           by using the -f option and specifying the original
                           image as the palette file).

          Related options  -Y   Scale in vertical dimension
                           -+   Preserve aspect ratio

          Examples         Scale the input image, test.gif, to 640 by 480
                           using good quality scaling, calling the output
                           file test2.gif:

                                alchemy test.gif -Xb640 -Yb480 -g test2.gif

                           Scale the input image, big.tga, using fast scaling
                           to an image which is 320 pixels across and the
                           same aspect ratio as the input image, calling the
                           output file out.tga:

                                alchemy big.tga -X320 -+ -a out


                                                   Image Alchemy          155




                           Scale the input image, oddsize.gif, using the
                           highest quality scaling, to an image which is no
                           larger than 640x480, but has the same aspect ratio
                           as the original image, calling the output image
                           new.gif:

                                alchemy oddsize.gif -Yd480 -Xd640 -+ new.gif
                                -g

                           Do the same thing as the previous example, but
                           retain the same palette:

                                alchemy oddsize.gif -Yd480 -Xd640 -+ new.gif
                                -g -f oddsize.gif








































          156          Image Alchemy




          Scale Image in Vertical Direction                         -Y


          Purpose          Scale the vertical dimension of the image to the
                           specified number of pixels.

          Syntax           -Y[scaleType] pixels

          Parameters       ScaleType
                                The type of scaling to use:
                                   a: nearest neighbor
                                   b: averaging/linear interpolation
                                   c: lanczos2
                                   d: lanczos3
                                The default is nearest neighbor.

                           pixels
                                The number of pixels in the vertical
                           dimension.

          Comments         Nearest neighbor type scaling is faster than the
                           other types but introduces aliasing.  The highest
                           quality scaling supported is lanczos3, but it
                           takes much longer than averaging/linear
                           interpolation and generally doesn't produce
                           significantly better results.

          Limitations      All of the scale types other than nearest neighbor
                           give much better results than nearest neighbor
                           scaling, but they are slower and require a new
                           palette to be generated for paletted output files
                           (you can force alchemy to use the original palette
                           by using the -f option and specifying the original
                           file name).

          Related options  -X   Scale in vertical dimension
                           -+   Preserve aspect ratio

          Examples         See the -X option, Scale Image in Horizontal
                           Direction, for examples.














                                                   Image Alchemy          157




          Specify Image Aspect Ratio                                -D


          Purpose          Specify aspect ratio for the output image.

          Syntax           -D aspectRatio

          Parameter        aspectRatio
                                The percentage of the width of a pixel to its
                           height.

          Comments         This option does not actually change the aspect
                           ratio of the image, it just adds the aspect ratio
                           value to the output file.  This is important when
                           trying to export the image to software which
                           expects this information.

                           The aspect ratio of an image is the ratio of the
                           width of a single pixel to the height of a single
                           pixel.  (So to specify an aspect ratio of 5:6 use
                           -D 83, since (5/6)*100 is 83).

                           Alchemy attempts to preserve the aspect ratio
                           value when converting images whenever one is found
                           in the input image, but since so few file formats
                           have aspect ratio information this hardly ever
                           happens.

                           To write an output image without aspect ratio
                           information specify an aspect ratio of 0 (zero).

                           This option can also be used when displaying an
                           image on an IBM PC.

          Limitations      It is not possible to specify both an aspect ratio
                           and a dots per inch value for an image.  This is
                           because specifying a dots per inch value
                           automatically implies an aspect ratio.

                           Many file types do not have an aspect ratio value,
                           so specifying one will have no effect.

          Related options  -D   Specify resolution

          Examples         You are converting a 640x350 IBM EGA PCX image
                           called ega.pcx (which has an aspect ratio of
                           35:48) to a TIFF image and you want the TIFF image
                           to have the correct aspect ratio value (so that an
                           intelligent TIFF reader will correctly interpret
                           the image) (Note that the value of 73 is
                           (35/48)*100):



          158          Image Alchemy




                                alchemy ega.pcx -D 73 -t

                           The resulting image will still be 640x350, but the
                           TIFF file now contains the information that the
                           pixels are not square (and in fact are 35:48).

                           If you had instead wanted to convert the image to
                           a 640 by 480 image (with square pixels) you could
                           have used:

                                alchemy ega.pcx -Y480 -D100 -t

                           The -D option isn't really needed here, since any
                           software reading the TIFF file will assume that if
                           there is no aspect ratio specified the pixels are
                           square.






































                                                   Image Alchemy          159




          Specify Image Resolution                                  -D


          Purpose          Specify image resolution in dots per inch for the
                           output image.

          Syntax           -D dotsPerInchX dotsPerInchY

          Parameters       dotsPerInchX
                                The resolution of the image in the X
                           direction in dots per inch.

                           dotsPerInchY
                                The resolution of the image in the Y
                           direction in dots per inch.

          Comments         You must specify both dotsPerInchX and
                           dotsPerInchY, even if they are the same.

                           This command does not actually change the
                           resolution of the image, it just adds the
                           resolution fields to the output image.  This is
                           important when trying to import the image into
                           software which expects this information.  For
                           example, Microsoft Word is much more likely to
                           give the expected results when importing a TIFF
                           image for printing on a laser printer if the image
                           has a resolution of 300 dpi.

                           Reasonable values to use for dotsPerInch include
                           72 (the resolution of a 13 inch monitor displaying
                           640x480) and 300 (the resolution of a laser
                           printer).

                           To write an output image without resolution
                           information specify a resolution of 0 0 (zero
                           zero).

                           Alchemy will preserve this information when
                           converting files whenever possible.



          Limitations      It is not possible to specify both an aspect ratio
                           and a dots per inch value for an image.  This is
                           because specifying a dots per inch value
                           automatically implies an aspect ratio.

                           This option is ignored when writing a file format
                           which does not have image resolution.

          Related options  -D   Specify aspect ratio


          160          Image Alchemy




          Example          Convert the Targa file input.tga to a TIFF file
                           called output.tif, specifying that the resolution
                           of the image in the TIFF file is 300 dpi by 300
                           dpi:

                                alchemy -t input.tga -D 300 300 output

                           Convert the file scan.tif to a DCX variation of a
                           PCX file, scaling the output image to 1500 by 750
                           (preserving the images aspect ratio) and setting
                           the resolution to 200dpi by 100dpi (this is useful
                           if you will be faxing the image using a fax card):

                                alchemy scan.tif -p1 -X1500 -Y750 -+
                                -D 200 100







































                                                   Image Alchemy          161




                                                                            8



          Viewing Options


          MS-DOS Only
          -------------------------------------------------------------------



          Display          Image Alchemy can display images on properly
          hardware         equipped MS-DOS based computers.


                           Depending on the hardware installed, Alchemy
                           supports 320x200x256, 360x480x256, 640x400x256,
                           640x480x256, 800x600x256, 1024x768x256,
                           1280x1024x256, 640x480x32768, and 800x600x32768
                           display resolutions.


                           Alchemy automatically detects which type of
                           display board you have installed.  If there are
                           multiple display boards installed in one computer
                           then Alchemy will display images on the first
                           board it finds,  searching in the following order:


                              Western Digital based 8514/A board


                              AI compatible 8514/A board


                              VESA compatible SVGA board


                              Other SVGA board.





          Western Digital  8514/A boards which are equipped with the Western
                   8514/A  Digital chipset are automatically recognized by
                           Alchemy.  Depending on the model board and the
                           amount of memory installed, 640x480x256,
                           1024x768x256, and 1280x1024x256 modes are
                           available.



          162          Image Alchemy




                AI 8514/A  Alchemy requires AI to be installed to use 8514/A
                           displays which aren't based on the Western Digital
                           chipset.  In addition to 8514/A boards Alchemy
                           should also be able to display on other AI
                           compatible boards, such as 340x0 based boards;
                           however this has not been tested.  For AI based
                           boards the only resolution available is
                           1024x768x256

                     VESA  The best support for SVGA boards is available for
                           VESA compatible SVGA boards.  VESA is a SVGA
                           standard which allows applications software, such
                           as Image Alchemy, to interrogate the SVGA board to
                           determine which display modes are available.  Some
                           SVGA boards have VESA support built directly into
                           the BIOS found on the board; in this case Alchemy
                           will automatically detect the VESA driver and use
                           it.  Other SVGA boards require a software driver
                           to be installed;  these drivers are usually found
                           on the floppy disks which came with your SVGA
                           board (typically the driver is called VESA.EXE).
                           If you can't find a driver on the diskettes and
                           the documentation does not explicitly mention that
                           VESA support is built into the BIOS you might call
                           the manufacturer to see if a VESA driver is
                           available.  VESA drivers are currently available
                           for VGA boards using chipsets from Cirrus Logic,
                           ATI Technologies, Chips and Technologies, Everex
                           Systems, Genoa Systems, Paradise Logic, Sigma
                           Designs, STB Systems, Tecmar, Headland Technology
                           (Video 7), Orchid Technology, Appian Technology,
                           Trident Microsystems, and Oak Technology.


               Other SVGA  If Alchemy cannot find a VESA SVGA board it
                           attempts to determine what kind of SVGA board is
                           present.


                           The 320x200x256 mode is a standard IBM VGA mode
                           and will work on all VGA boards.  The 360x480x256
                           is a non-standard VGA mode which should also work
                           on all VGA boards.

                           Because of various incompatibilities between
                           different VGA boards, 640x400x256 and/or
                           640x480x256 modes are not supported on some VGA
                           boards.  VGA boards which have been tested for the
                           higher resolution modes include Paradise, Tseng
                           Labs 3000 & 4000, Video 7, Trident, and Everex
                           chipset based VGA Boards.



                                                   Image Alchemy          163





          General          Unless you explicitly specify a resolution,
                           Alchemy automatically uses the lowest resolution
                           mode which will display the entire picture.


                           The image will be positioned so that its center
                           coincides with that of the display.














































          164          Image Alchemy




          Offset View                                               -_


          Purpose          The offset view option is used to position the
                           image on the screen during viewing.

          Syntax           -_ xOffset yOffset (dash underscore)

          Parameter        xOffset  Number of pixels to shift the image
                           horizontally.

                           yOffset  Number of pixels to shift the image
                           vertically.

          Example


                           View moving the image up 100 pixels:

                                alchemy madonna.gif -v -_ 0 -100

                           View moving the image to the right 200 pixels and
                           down 50 pixels:

                                alchemy madonna.gif -v -_ 200 50





























                                                   Image Alchemy          165




          View Image                                                -v


          Purpose          View file.

          Syntax           -v horizontalResolution

          Parameter        horizontalResolution
                                320:Use 320x200 mode
                                360:Use 360x480 mode
                                640:Use 640x480 mode
                                800:Use 800x600 mode
                                1024:Use 1024x768 mode
                                1280:Use 1280x1024 mode

          Comments         If displaying on a Western Digital chipset 8514/A
                           or VESA compatible VGA, an optional parameter may
                           follow the -v command.  This parameter specifies
                           horizontal resolution and may be 320, 360, 640,
                           800, 1024, or 1280.  The default is to use the
                           lowest resolution which can fit the entire image.

                           If the image is true colour, a uniform palette
                           will be used and the image will be dithered
                           (dithering may be disabled by use of the -d
                           option, see above).  See Appendix B, Colour and
                           Dithering, for more information.

          Related options  -V   Reduce image to fit display

          Example          View the image madonna.gif:

                                alchemy madonna.gif -v





















          166          Image Alchemy




          View Image in True Colour Mode                           --v


          Purpose          View file using 15, 16, or 24 bits/pixel mode.
                           This allows true colour images to be viewed
                           without dithering to a uniform palette.

          Syntax           --v horizontalResolution

          Parameter        horizontalResolution
                                640:Use 640x480 mode
                                800:Use 800x600 mode
                                1024:Use 1024x768 mode
                                1280:Use 1280x1024 mode

          Comments         Resolutions above 640x480 are only supported by
                           SVGA boards with a VESA driver.  640x480 mode is
                           supported for various SVGA boards with sufficient
                           memory and the correct DAC.

                           Alchemy automatically picks the highest colour
                           resolution which will fit the image you are trying
                           to view.  For example, if your  SVGA boards
                           supports 800x600x15 bit and 640x480x24 bit,
                           Alchemy will use the 640x480x24 bit mode when
                           viewing images which are 640x480 and smaller and
                           the 800x600 mode when viewing larger images.  You
                           can of course override this by giving Alchemy a
                           resolution parameter after the view command (for
                           example, --v 640, to view in 640x480x24 bit mode).

          Example          View madonna.tga:

                                alchemy madonna.tga --v




















                                                   Image Alchemy          167




          View Scaled Image                                         -V


          Purpose          View image while scaling image to fit on monitor
                           and correcting aspect ratio.

          Syntax           -V horizontalResolution

          Parameter        horizontalResolution
                                320:Use 320x200 mode
                                360:Use 360x480 mode
                                640:Use 640x480 mode
                                800:Use 800x600 mode
                                1024:Use 1024x768 mode
                                1280:Use 1280x1024 mode

          Comments         This command will scale the image and correct the
                           aspect ratio of the image by removing rows and/or
                           columns from the image.

                           Note that this option can also be useful for
                           displaying images which are not larger than the
                           screen but which have an aspect ratio different
                           than the display.

          Limitations      Alchemy assumes that the aspect ratio of a display
                           pixel is 1:1 when in 640x480, 800x600, 1024x768,
                           and 1280x1024 modes, 5:6 when in 640x400 mode and
                           320x200 modes, and 16:9 in 360x480 mode.

                           If not otherwise specified by using the -D option
                           or in the file, Alchemy assumes that the aspect
                           ratio of pixels in 640x400 images and 320x200
                           images is 5:6 and the aspect ratio of pixels in
                           640x350 images is 35:48.  You can override any of
                           these assumptions with the -D option.

                           Don't worry if this is confusing;  in practice
                           Alchemy deals with everything automatically if you
                           use the -V option.  However, there is a problem
                           with displaying 320x400 IFF files; see Appendix A,
                           Answers to Frequently Asked Questions, for more
                           information.

          Related options  -D   Specify image resolution
                           -v   View image

          Example          View madonna.gif:

                                alchemy madonna.gif -V




          168          Image Alchemy




          View Scaled Image in True Colour Mode                    --V


          Purpose          View image in 15 bit mode while scaling image to
                           fit on monitor and correcting aspect ratio.

          Syntax           --V horizontalResolution

          Parameter        horizontalResolution
                                640:Use 640x480 mode
                                800:Use 800x600 mode
                                1024:Use 1024x768 mode
                                1280:Use 1280x1024 mode

          Comments         Requires either a Tseng 4000 equipped SVGA, an S3
                           equipped SVGA board, or a VESA compatible SVGA
                           board with a Sierra DAC and 1 Megabyte of memory
                           on the SVGA board.

                           This command will scale the image and correct the
                           aspect ratio of the image by removing rows and/or
                           columns from the image.

                           Note that this option can also be useful for
                           displaying images which are not larger than the
                           screen but which have an aspect ratio different
                           than the display.

          Limitations      The same limitations as for scaled 8 bit viewing
                           apply (see page 7-7 in the User's Manual).

          Related options  -D   Specify image resolution
                           --v  View image in 15 bit mode

          Example          View sample.jpg:

                                alchemy sample.jpg --V

















                                                   Image Alchemy          169




                                                                            9



          Tutorial and Examples
          -------------------------------------------------------------------


          Introduction     This section gives a sample session of using the
                           command-line version of Alchemy.  It is assumed
                           that you have installed Alchemy as instructed by
                           the installation section of the manual.  The
                           sample image file, sample.jpg, which can be found
                           in the samples directory on the distribution disk
                           or tape, must be in the current directory.

          Examples         We will use the sample.jpg image supplied in the
                           \samples directory.  The first step is to copy
                           this into the directory with Alchemy.

                                copy samples\sample.jpg

                           Now we will convert this JPEG file to a GIF file.
                           Notice that we don't have to specify an output
                           file name.  Alchemy will automatically supply the
                           name sample.gif.

                                alchemy sample.jpg -g

                           We can then view this GIF file using Image Alchemy
                           (assuming you have a compatible Super VGA card):

                                alchemy sample.gif -v

                           To convert the sample.gif file to a PCX file
                           called test1.pcx do the following:

                                alchemy sample.gif test1.pcx -p

                           You can now view this file by doing:

                                alchemy test1 -v

                           Note here that Alchemy automatically added the
                           extension .pcx since none was supplied.

                           Let us now convert the test1.pcx file to a small
                           TIFF file called test1.tif, we will scale the TIFF
                           file to be 200x100 pixels.  To perform the scaling
                           we will use -X and -Y options:

                                alchemy test1.pcx -t -Xb200 -Yb100


          170          Image Alchemy




                           In this case we specified that Alchemy should use
                           type B scaling.  This is a good scaling type to
                           use for general purpose scaling (type A scaling is
                           faster but not as good a quality, whereas Type C
                           and Type D scaling are better quality but slower).

                           You can now view this TIFF file by using:

                                alchemy test1.tif -v

                           If you had wanted to view it using the standard
                           VGA mode 320x200 you could have used:

                                alchemy test1.tif -v320

                           To convert this TIFF file to a gray-scale PCX file
                           use

                                alchemy test1.tif -b -p -o

                           The -b option indicates black and white and the -o
                           option tells Alchemy that it is okay to overwrite
                           the existing test1.pcx file.

                           You can now view this PCX file by using:

                                alchemy test1.pcx -v



                           To convert the JPEG file sample.jpg to a Targa
                           file called sample.tga use the following command:

                                alchemy -a sample.jpg

                           To convert the 24 bit Targa file sample.tga to a
                           256 colour GIF file called new.gif:

                                alchemy -g sample.tga new.gif

                           To convert the 256 colour GIF file, new.gif, to a
                           64 colour PCX file called new.pcx:

                                alchemy -p -c64 new.gif

                           To view the GIF file new.gif (only applicable on
                           IBM PCs with appropriate VGA board):

                                alchemy -v new.gif





                                                   Image Alchemy          171




                           To convert sample.jpg to a black and white, two
                           colour GIF file use a text editor to create a file
                           called BW.PAL which contains the following:

                                PAL
                                2
                                0 0 0
                                255 255 255

                           then:

                                alchemy -g sample.jpg -f bw.pal

                           (Alternatively, you could have said alchemy -g
                           sample.jpg -b -c2, but that wouldn't have
                           demonstrated the -f option).

                           To view the resulting file in 320x200x256 mode,
                           scaling the image to fit the display:

                                alchemy -V320 sample.gif

                           To create a LZW compressed TIFF file called
                           new.tif which is 320x240 from the targa file
                           created earlier, using good quality scaling:

                                alchemy sample.tga -t1 -Xb320 -+ new.tif



























          172          Image Alchemy




                                                                            A



          Answers to Frequently Asked Questions
          -------------------------------------------------------------------



                 Question  When I view a JPEG compressed image on my VGA
                           board it looks much worse than when I first
                           convert it to a GIF file and then view it.  Why is
                           this?

                   Answer  To save time Alchemy automatically uses a uniform
                           palette when you are just viewing a true colour
                           image.  When converting to a different file format
                           Alchemy uses Heckbert quantization to generate a
                           palette.  The difference in image quality is the
                           difference between using a uniform palette and an
                           optimum palette.  See Appendix B, Colour and
                           Dithering, for more information on palette
                           generation.


                 Question  Why can't my paint package read the Targa file I
                           wrote with Image Alchemy?

                   Answer  Some software which reads Targa files cannot
                           handle compressed files.  In addition, some
                           software can read true colour Targa files, but
                           cannot read paletted or gray-scale files.  Image
                           Alchemy can be forced to write out a true colour
                           file by using the -24 option.


                 Question  I told Alchemy to convert a PCX file to an 8 bit
                           GIF file (using the -8 option).  Yet when I get
                           statistics on the file (using -x) Alchemy reports
                           the file only has 16 colours.

                   Answer  Alchemy will always store the file using the
                           smallest bits-per-pixel allowable for the given
                           image (this results in the smallest possible
                           file).  In this case the input file only had 16
                           colours in it.








                                                   Image Alchemy          173




                           Things get more unpredictable with formats such as
                           Sun Raster (which requires 1 bit files to be black
                           and white) and SGI (which requires 8 bit files to
                           be gray-scale).  In these cases Alchemy will
                           always do the best it can (giving you a warning
                           message if it does something which may surprise
                           you later).


                 Question  Why is decompressing or compressing a JPEG image
                           so slow?

                   Answer  There are a large number of calculations that have
                           to be done during JPEG compression.  This is an
                           inherent limitation of JPEG compression.  Image
                           Alchemy has been optimized quite a bit to reduce
                           the number of calculations, and we are working to
                           further reduce the number of calculations.  If you
                           are transferring files over modems or storing them
                           on slow media (tape) the compression times are
                           usually more than made up for by the decrease in
                           transmission or retrieval times.


                 Question  Why can't my favorite desktop publishing package
                           read the TIFF file I wrote with Image Alchemy?

                   Answer  Tagged Interchange File FormatTIFF is an extremely
                           versatile standard; it can handle anything from 1
                           bit images to full colour images with an alpha
                           channel.  Also, TIFF allows many different types
                           of compression.  Unfortunately this versatility
                           means that it's difficult for a single piece of
                           software to be able to read in every valid TIFF
                           file.


                           If the software specifies the classes of TIFF it
                           can read, you can force Alchemy to write out a
                           specific TIFF class by using the following
                           options:
                              class B: -8 -b -c2 -t2
                              class G: -8 -b -t1
                              class P: -8 -t1
                              class R: -24 -t1

                           Class B is black and white, Class G is gray-scale,
                           Class P is paletted, and Class R is true colour.






          174          Image Alchemy




                           If the supported classes are not specified,
                           experiment with various combinations of -24, -8, -
                           b, and -c.  In this case it is usually best to use
                           no compression (-t0) while experimenting with the
                           other options, as many TIFF readers have
                           difficulty with compressed files.  When you find a
                           set of options that work, then you can try various
                           compression modes to save space.  Be aware that
                           using the -b option will force the output file to
                           be gray-scale and you will lose the colour
                           information in the file (most desktop publishing
                           programs only have support for gray-scale TIFF
                           files).


                           You may also have to use the -Dn n option to
                           specify the resolution of the image (this is
                           especially true when converting from a file format
                           which does not have a value for image resolution).
                           You can generally tell if this is necessary
                           because the program you are using to read in the
                           TIFF file will claim that the file is unreasonably
                           large or small.  Generally, if you are using a 300
                           DPI Laser Printer you want to make the TIFF file
                           300DPI x 300DPI (-D 300 300).


                           If you would like further information specific to
                           using Image Alchemy with your word processor or
                           desktop publishing program please contact us; we
                           will be maintaining a list of how to make Alchemy
                           work with other software packages.  Similarly if
                           you figure out how to import files into a specific
                           package let us know and we will add your tips to
                           our documentation.



















                                                   Image Alchemy          175




                 Question  I've converted a Mac PICT file to a GIF file, but
                           the GIF file is missing some or all of the
                           information that was in the PICT file.  What
                           happened to it?

                   Answer  PICT files are a combination of drawing commands
                           (such as lines, rectangles, and circles) and
                           raster areas (called pixMaps).  Alchemy can only
                           read the raster portions of the files.  Programs
                           such as MacDraw and MacDraft write out files with
                           drawing commands, programs such as MacPaint write
                           out files which are entirely raster areas
                           (pixMaps), and some programs, such as SuperPaint
                           can write out files which are either, or a
                           combination of both.  If you are using such a
                           program check the documentation on how to write
                           out files in "paint" mode.


                 Question  When I convert a GIF file to a JPEG file and then
                           back to a GIF file the final GIF file is twice the
                           size of the original.  Why is this?

                   Answer  There are two things which might cause this to
                           happen:


                           JPEG compression doesn't really work well for
                           images which have large areas which are all the
                           same colour.  The reason for this is that JPEG is
                           a lossy compression technique.  Therefore you are
                           not going to get back exactly the same values for
                           each pixel in an area that was one solid colour
                           before being JPEG compressed.  But GIF compression
                           works much better on areas which are one solid
                           colour, so, when you GIF compress these areas,
                           they are quite a bit larger than they were before.
                           The solution to this problem is to use HSI JPEG
                           compression, which automatically detects large
                           areas of solid colours and does not JPEG compress
                           them.  The problem with HSI JPEG compression is
                           that it isn't compatible with JPEG or JFIF.












          176          Image Alchemy




                           The other possibility is that the input GIF file
                           didn't have very many different colours.  When you
                           converted it to a JPEG file the number of colours
                           in the file was lost (JPEG gray-scale files always
                           use 256 shades, and JPEG colour files are always
                           true colour).  When the JPEG file was converted
                           back to a GIF file Alchemy assumed you wanted 256
                           colours in the file, and a 256 colour GIF file is
                           bigger than a 16 colour GIF file.  To prevent this
                           you can use a -c32 (or however many colours the
                           original had) option in the command line; this
                           forces Image Alchemy to use that many colours for
                           the output file.


                 Question  I keep getting "Out of Memory trying to ..."
                           messages.  Help!

                   Answer  Image Alchemy is running out of memory.  First try
                           to do the conversion again with the -$ (conserve
                           memory) option.  Next, if that doesn't help,
                           attempt to maximize the amount of memory available
                           by removing as many memory resident programs as
                           you can.  If this still doesn't help please
                           contact us with the following information: your
                           computer configuration (amount of available
                           memory, size of hard disk), operating system
                           version, and what you are trying to do (input file
                           information (size of image and type of file) and
                           options specified).  Alchemy can generally convert
                           images as larger than 2000 pixels wide and a
                           virtually unlimited number of pixels tall.
                           However there are certain conversions which
                           require more memory than others.


                 Question  I am using Alchemy to display a 320x400 IFF image
                           created by an Amiga.  When I use just the -v
                           option the image comes out tall and skinny.  When
                           I use the -V option, which is supposed to correct
                           the aspect ratio, things get worse instead of
                           better (the image is even skinnier).  What's going
                           on?

                   Answer  As near as we can tell, some Amiga software has a
                           different idea of what aspect ratio is than the
                           rest of the world.







                                                   Image Alchemy          177




                           For displays, aspect ratio is defined as the ratio
                           of the width of a single pixel to the height of a
                           single pixel.  So if you have square pixels (which
                           you do on a standard monitor in 640x480 mode) the
                           aspect ratio is 1 to 1 (commonly written as 1:1).
                           When you change display modes the height and width
                           of the total display area does not change; what is
                           changing is the width and height of each pixel,
                           which means that the aspect ratio changes.  For
                           example, a 640x400 display has an aspect ratio of
                           1:1.2 (that means each pixel is 1.2 times as tall
                           as it is wide (which makes sense since 480/400
                           equals 1.2)).  A 640x200 display has an aspect
                           ratio of 1:2.4.


                           Now this is where it gets interesting in terms of
                           IFF files.  The aspect ratio number stored in
                           Amiga IFF files for 320x400 images is 1:1.1,
                           meaning pixels are 1.1 times as tall as they are
                           wide, so therefore the actual image should be the
                           equivalent size of a 320x440 image with square
                           pixels.  And this is what Alchemy will attempt to
                           display when you use the -V option (Alchemy never
                           makes any dimension larger, so the actual image
                           Alchemy displays is 291x400, which is the same
                           ratio as 320x440).  However this is obviously
                           wrong, as you can tell when you examine an image.
                           As near as we can tell the correct aspect ratio of
                           these images is 5:3 (the math we used to come up
                           with this number is 640/320:480/400).  And if you
                           tell Alchemy to override the aspect ratio by using
                           a -D 167 option (167 because 5/3*100 is 166.6666)
                           the image displays correctly.  Why Amigas create
                           images which claim they are 1:1.1 remains a
                           mystery.


















          178          Image Alchemy




                 Question  When I convert a 32 bit Targa file to a GIF file
                           and then to a JPEG file it doesn't look nearly as
                           good as if I convert the Targa File directly to
                           the JPEG file.  What can I do to maintain high
                           quality in JPEG compressed files?

                   Answer  When the Targa file was converted to the GIF file
                           Image Alchemy had to reduce the number of colours
                           in the file (the original Targa File had up to 16
                           million colours, GIF files are limited to 256
                           colours).  This step is known as colour
                           quantization (Image Alchemy uses the Heckbert
                           Median Cut method for quantization, see Appendix
                           B, Colour and Dithering, for more information).
                           The difficulty with colour quantization is that it
                           leaves artifacts known as colour banding.  To
                           reduce this phenomenon Image Alchemy dithers the
                           image (you can see the effect of colour banding by
                           turning off dithering by using the -d0 option).
                           Unfortunately a dithered image does not JPEG
                           compress very well (dithering adds a lot of high-
                           frequency information to an image; JPEG
                           compression attempts to remove much of that
                           information).  In addition JPEG images are always
                           continuous colour images, so when the JPEG file is
                           decompressed it has to be colour quantized and
                           dithered again.  Dithering a previously dithered
                           image reduces the quality even more.  The solution
                           is to use the best starting quality you can for
                           JPEG compression, ideally a continuous tone image.
                           The compressed image size will be smaller than if
                           you had started with a paletted image and the
                           quality will be better.


                 Question  I've converted an HP PCL file to a GIF file, but
                           the GIF file is missing some or all of the
                           information that was in the PCL file.  What
                           happened to it?

                   Answer  PCL files have the same problem as PICT files (see
                           above); they are a combination of drawing commands
                           (such as lines and rectangles) and raster areas
                           (called rasters) and Alchemy can only convert the
                           raster areas in PCL files.  PCL Files also contain
                           font and text information, which is also lost.
                           Unfortunately there isn't any general way to
                           preserve this data with Alchemy.






                                                   Image Alchemy          179




                           One thing which you can do if running Microsoft
                           Windows 3.0 is to install Adobe Type Manager
                           (ATM).  ATM automatically intercepts any text
                           commands and converts them to rasters.  In
                           addition, the standard Windows 3.0 HP PCL driver
                           only generates rasters, not vectors.  So the file
                           will appear in its entirety when converted by
                           Alchemy.  Contact us if you want further
                           information on using Alchemy with Windows 3.0.


                 Question  Why can't Image Alchemy read in JPEG files
                           produced by Kodak's ColorSqueeze (or Sun's
                           VFCtool)?

                   Answer  The JPEG standard is still in draft form.  Until
                           it is a mature standard, various manufacturer's
                           will implement different versions of it.  As of
                           March 1, 1991 Image Alchemy supports the JFIF
                           format and should work with any other JPEG
                           software which also claims JFIF compatibility.  If
                           other software you are using claims to support the
                           JFIF format and you are having trouble please
                           contact us.  If the other software does not
                           support JFIF, contact the manufacturer and tell
                           them they should send you an update which does
                           (you can tell them to contact us if they need a
                           copy of the JFIF standard).


                 Question  I converted a PCX file with 16 colours to a 16
                           shades of gray TIFF file using the -b and -t
                           options.  The 16 colour PCX file had some shades
                           of gray in it which were changed in the TIFF file.
                           How can I prevent this?

                   Answer  The problem is that gray-scale TIFF files have a
                           uniformly spaced gray palette.  If you create a
                           TIFF file with 16 shades of gray it will have the
                           following shades in it: 0, 17, 34, 51, 68, 85,
                           102, 119, 136, 153, 170, 187, 204, 221, 238, and
                           255.  However the 16 colour PCX file you started
                           with probably didn't have those exact colours in
                           it (for example, PCX files written out by
                           Windows 3.0 Paint have shades of gray which
                           correspond to 0, 128, 192, and 255).  So Alchemy
                           did the best it could and matched the input
                           colours to the output colours (and depending on
                           the other options that you specified may also have
                           dithered the image).




          180          Image Alchemy




                           The solution is to tell Alchemy to write out a 256
                           colour gray-scale TIFF file (which you do by
                           adding a -c256 to the -b and -t options).  This
                           file still has a uniform gray palette; but that
                           palette now contains every colour:  0, 1, 2, 3,
                           ..., 255.  Therefore Alchemy can map, for example,
                           the colours 128 and 192 to their exact match.
                           This does have the disadvantage of making the
                           resulting 256 colour TIFF file twice as large as
                           the 16 colour TIFF file, but this is the only way
                           to guarantee that Alchemy can find an exact match
                           for all the shades of gray in the input file.


                 Question  Why do you only allow specifying image resolution
                           in Dots Per Inch?  Don't you realize that most of
                           the world is metric?

                   Answer  Yes, we do realize that the entire world, with the
                           exception of the United States and Great Britain,
                           claims to use the metric system exclusively (and
                           Great Britain will presumably change in 1992).
                           However, this isn't actually true.  A laser
                           printer manufactured in Japan is still 300 dots
                           per inch (not 11.811... dots per mm) and a 19 inch
                           monitor sold in Europe is called a 19 inch monitor
                           (actually a 19 inch monitor is called a 20 inch
                           monitor in Europe, which is a measure of the total
                           picture tube diagonal, not just the viewing area).

                 Question  How do I get a copy of the current draft JPEG
                           standard?

                   Answer  The JPEG standard is a ISO/IEC standard currently
                           in Committee Draft form.

                           Contact your local ISO/IEC office to get a copy.
                           The reference numbers are ISO/IEC JTC 1 and /SC 2
                           N2215; the document number is ISO/IEC CD 10918-1.

                           In the United States you can contact ANSI at:
                              ANSI
                              11 West 42nd St.
                              New York, NY  10036
                              (212) 642-4900


                 Question  Do you give multiple copy discounts?  Do you have
                           site licenses?  Are you interested in licensing
                           the source code?

                   Answer  Yes.  Yes.  Yes.  Contact us for more information.


                                                   Image Alchemy          181


























































          182          Image Alchemy




                                                                            B



          Colour and Dithering
          -------------------------------------------------------------------


          Paletted vs.     Colour images are normally stored in one of two
          true colour      ways: as an array of direct colour values (usually
                           red, green, and blue) (referred to as a true
                           colour file in this document) or as an array of
                           indices into a colour-map which contains red,
                           green, and blue colour values (referred to as a
                           paletted file in this document).


                           The reason for the existence of paletted images is
                           that they take less memory, so the hardware to
                           display them is less expensive.  The dominance of
                           paletted hardware is changing as the price of
                           memory and the processing power it takes to update
                           large amounts of memory at a reasonable speed
                           drops (a Targa 32 board is an example of a true
                           colour board, a VGA board is an example of a
                           paletted board).


                           Until true colour graphics devices become the
                           norm, there is a need to convert images from true
                           colour to paletted.  This conversion is done in
                           two steps: the first is to generate a palette for
                           use by the image;  the second is to map the image
                           to the new palette.

          Colour cube      The colour model generally used by computers is a
                           cube with red, green, and blue as the axes (this
                           is known as a colour cube or RGB cube).  Each
                           point inside the cube is a different colour,
                           depending on the amount of red, green, and blue
                           used.  In nature each of the three axes is nearly
                           continuous, therefore there are a nearly infinite
                           number of colours available.  Computer hardware
                           and software represent colours in a discrete
                           fashion.









                                                   Image Alchemy          183




                           For true colour displays or file formats the
                           number of discrete positions along each axis of
                           the colour cube gives the colour resolution of the
                           output device.  For example, a Targa 24 board for
                           an IBM PC has 8 bits per red, green, and blue
                           channel for a total of 24 bits (or 256 discrete
                           shades of each colour, for a total of 16 million
                           colours (256x256x256)).  This is also the colour
                           resolution of most true colour file formats.


                           The new 15 bit SVGA boards have 5 bits per
                           channel, for a total of 32x32x32 different colours
                           (32,768).  This is the same colour resolution as a
                           Targa 15 file.


                           A paletted display or image file has the same
                           colour resolution limit as a true colour display
                           or image file, but in addition there is a limit on
                           how many points inside the cube can be used at the
                           same time.  An 8 bit file format, such as GIF,
                           allows 256 different colours out of 16 million.  A
                           normal SVGA board also only allows 256 different
                           colours at one time.


                           So, converting a true colour file to a paletted
                           file involves reducing the number of occupied
                           points in the colour cube.  There are several ways
                           this can be done.


          Generating a     Image Alchemy supports two methods of generating a
          palette          palette:

                  Uniform  The simplest and fastest method is to use a
                 palettes  palette containing colours which are uniformly
                           distributed in the RGB cube, referred to as a
                           uniform palette.  This has the advantage that it's
                           fast and the same palette can be used for any
                           image; the primary disadvantage is that most
                           images don't contain colours from everywhere in
                           the RGB cube, so palette entries are wasted
                           representing colours that aren't needed for the
                           particular image being converted.








          184          Image Alchemy




                  Optimal  To generate a palette which is better for
                 palettes  representing a particular image, Image Alchemy
                           supports Heckbert's median cut algorithm.  This
                           algorithm first builds a three dimensional table
                           (a histogram cube) indicating how popular any
                           given colour in the RGB cube is in the image being
                           converted.  It then proceeds to subdivide this
                           histogram cube (by dividing boxes in half) until
                           it has created as many boxes as there are palette
                           entries.  The decision as to where to divide a box
                           is based on the distribution of colours within the
                           box.  This algorithm attempts to create boxes
                           which have approximately equal popularity in the
                           image.

                           Palette entries are then assigned to represent
                           each box.  There are other methods of generating a
                           palette from an image, but Heckbert's algorithm is
                           generally regarded as the best tradeoff between
                           speed and quality.


            Modifying the  You can change the method used to select a colour
                  palette  to represent each box by use of the -z options.
                selection
                  process  The default method is to use the mean of all the
                           colours in the box.  However for some images
                           slightly better results can be obtained by using
                           the center of the box (without regard to where the
                           pixels are in the box).

                           For images being reduced to a very small number of
                           colours (less than 16) better results can be
                           obtained by using a corner of the box (the boxes
                           tend to be large when reducing an image to a small
                           number of colours; therefore picking colours near
                           the centers of the boxes will give you muddy
                           colours, while using corners of the boxes will
                           give you more saturated colours).



          Mapping the      The next step is to map the image to the new
          image to the     palette; this is where dithering becomes
          palette          important.









                                                   Image Alchemy          185




             No dithering  The simplest approach is to map every colour in
                           the original image to the palette entry which is
                           closest to it (this is what Image Alchemy does if
                           you specify no dithering).

                           However, since the palette entries generally
                           represent several different colours in the
                           original image, this results in colour banding
                           where areas of smooth colour changes in the
                           original become areas of one solid colour in the
                           paletted version.

            Advantages of  This can be alleviated by dithering the image data
                dithering  such that any given pixel might not be mapped to
                           its closest palette entry, but the average over
                           some area of the image will be closer to the
                           correct colour than it would otherwise be.  Image
                           Alchemy uses a class of algorithms called "error-
                           diffusion" to do dithering.

          Error diffusion  These algorithms work by using the closest palette
                dithering  entry to a colour and then distributing the error
                           (the difference between the desired colour and the
                           chosen palette entry) to the nearby pixels.  This
                           process is repeated for every pixel in the image,
                           using the colour values which have been modified
                           due to the error from previous pixels.  The
                           different dithering algorithms spread the error
                           over a different area or use a different weighting
                           within the same area.

               Serpentine  Error diffusion can be done as a normal raster
                   raster  (left to right, top to bottom) or as a serpentine
                           raster (alternating left to right and right to
                           left, top to bottom).  A serpentine raster tends
                           to break up visible patterns introduced by
                           dithering.

                    Noise  Random noise can also be added to help break up
                           visible patterns in the resulting image.


          Further          For more information on Heckbert's median cut and
          information      dithering see the appropriate reference listed in
                           the References section below.









          186          Image Alchemy




                                                                            C



          What is JPEG Compression?
          -------------------------------------------------------------------


          Who are those    JPEG stands for the "Joint Photographic Experts
          JPEG guys?       Group".  This is a group of experts who defined a
                           standard compression scheme for still images,
                           commonly called JPEG Compression.  Currently the
                           standard is still in draft form.  The standard
                           should be finalized in 1991.

          Overview         JPEG Compression consists of a series of
                           reasonably complex mathematical operations.  These
                           include: colour space conversion, discrete cosine
                           transforms, quantization, and entropy coding.
                           After these steps you end up with an image which
                           takes fewer bits to store than you started out
                           with.

                           However, when you decompress a JPEG compressed
                           image you end up with an image that is not quite
                           the same as the original  (which is why JPEG
                           Compression is referred to as "lossy").

          Is lossy         You might well ask why anyone would want to
          compression      compress an image using a lossy technique.
          bad?             Compression ratios for lossy compression are much
                           better than for lossless compression and the loss
                           is generally very small.  And, in fact, every
                           operation of converting an image is lossy (the
                           original photographic or electronic process which
                           captured the image was lossy, scanning or
                           digitizing the image was lossy, displaying the
                           image on a monitor is lossy, and printing the
                           image is lossy).


          Details          JPEG compression involves the following steps:












                                                   Image Alchemy          187




                   Step 1  The image is converted to a colour space with
                           separate luminance and chrominance channels.  This
                           is done because the human eye is far more
                           sensitive to the luminance information (Y) than it
                           is to the chrominance information (Cb and Cr); by
                           separating them, it's possible to compress the
                           chrominance information more than the luminance
                           before the perceived image quality suffers.

                           This step isn't specified in the JPEG draft (it
                           doesn't discuss colour space at all), but is
                           standard practice.  Image Alchemy uses CCIR-601
                           YCbCr, which is the colour space specified by the
                           JFIF standard.

                   Step 2  The luminance and chrominance information are
                           separately transformed to the frequency domain
                           using a discrete cosine transform acting on 8x8
                           pixel blocks.

                           To reduce the amount of data which needs to be
                           compressed the chrominance information may be sub-
                           sampled first.  Alchemy uses 2h:1v:1h:1v:1h:1v
                           sub-sampling when writing JPEG files, which means
                           that the first component (luminance) has twice as
                           many samples horizontally as the other two
                           components (chrominance), and the same number of
                           samples vertically.  Alchemy can read JPEG files
                           with any sub-sampling allowed by the draft
                           standard.

                   Step 3  quantizationThe transformed data is quantized (so
                           some information is thrown away).  The samples
                           representing higher frequencies are generally
                           quantized using larger steps than those
                           representing low frequencies.

                           The quality level you specify is used to scale a
                           set of quantization values which have been found
                           to cause the quantized data to all have
                           approximately equal importance visually.  A lower
                           quality number will cause larger quantization
                           steps to be used, and hence increase the
                           compression ratio and decrease the image quality.










          188          Image Alchemy




                   Step 4  The quantized data is compressed using an entropy
                           coder.  Huffman and Arithmetic coding are allowed
                           by the draft JPEG standard; only Huffman coding is
                           allowed by the JFIF standard.  Huffman coding can
                           either be done with a set of fixed tables or
                           custom tables can be generated for an image.
                           Alchemy, by default, uses a fixed set of tables,
                           but can also generate custom tables which usually
                           produce 5-20% (depending on the image and quality
                           setting) better compression.  However, producing
                           custom tables requires an additional pass over the
                           image data and therefore takes a little longer.

                           Alchemy can write JPEG files using either Huffman
                           or arithmetic coding; arithmetic coding generally
                           results in a slightly smaller file, but at the
                           cost of non-JFIF compatibility and longer
                           compression and decompression times.

          JPEG             This data corresponds to the JPEG Interchange
          Interchange      Format and is ready to be stored in a file.
          Format           Unfortunately the JPEG Interchange Format does not
                           include enough information to actually be able to
                           convert the file back to an image.  Specifically
                           the colour space used and the aspect ratio or
                           resolution of the image are not included.  Until
                           recently there was no standard way of putting this
                           information in a JPEG file.

          JFIF             On March 1, 1991 representatives of several JPEG
                           hardware and software developers (including C-
                           Cube, Radius, NeXT, Storm Tech., the PD JPEG
                           group, Sun, and Handmade Software) met at C-Cube
                           and established the JPEG File Interchange Format
                           (JFIF).  If you would like more information on the
                           JFIF standard please contact us.


















                                                   Image Alchemy          189




                                                                            D



          Customer Support
          -------------------------------------------------------------------


          Why might        We have made every effort to insure that Image
          Alchemy mess     Alchemy can read all files in its supported
          up?              formats.  However, because of poorly written
                           standards and non-adherence to standards there are
                           undoubtedly certain files that Image Alchemy does
                           not read correctly.

          What we need to  If you come across any files which Image Alchemy
          help you         has trouble with please contact us with as much of
                           the following information as you have:  version of
                           Image Alchemy you are using, type of file, type of
                           computer which generated it, name and version of
                           software which wrote the file, size of image, and
                           the number of colours in image.  We may ask you to
                           send us the file so that we can figure out what
                           went wrong.  If you send us a file we will attempt
                           to modify Image Alchemy so that it can read the
                           file.  Once Image Alchemy is modified, we will
                           send you an updated copy of Image Alchemy.

                           Similarly, if any files that Image Alchemy writes
                           cannot be read by other software please contact
                           us.  We may ask you to send us a copy of a file
                           that can be read by that software package for
                           comparison.


                           Please contact us even if you are just using a
                           demo copy of Alchemy.  In addition to helping fix
                           a potential bug, we feel the best way to get you
                           to purchase a copy of Alchemy is to demonstrate
                           how committed we are to customer support.














          190          Image Alchemy




          How to contact   Our address and phone numbers are:
          us
                              Handmade Software, Inc.
                              15951 Los Gatos Blvd., Suite 17
                              Los Gatos, CA  95032

                              +1 800 358 3588 (Toll-free from the U.S.)
                              +1 408 358 1292 (Voice)
                              +1 408 358 2694 (Fax)

                           The most efficient way to contact us is by e-mail;
                           this is especially true if you can send us a
                           sample file which demonstrates the problem.  Our
                           e-mail addresses are:

                              Internet:  hsi@netcom.COM
                              CompuServe:  71330, 3136

                           We also have a 24 hour bulletin board BBS where
                           you can upload and download files.  It speaks 2400
                           baud, 9600 baud (v32, v42, and v42.bis), and PEP
                           and its number is:

                              +1 408 356-3297 (BBS)






























                                                   Image Alchemy          191




                                                                            E



          Binary Information Files (BIF)
          -------------------------------------------------------------------


          Overview         Binary files are image files which are just data.
                           In other words, they do not contain any
                           information other than the actual pixels in the
                           image.  In order to read these files you must
                           create a file using a text editor which describes
                           to Alchemy the format of the file you are trying
                           to read in.  This is called a BIF file (and
                           normally has the extension .bif).

          Required         At the minimum a BIF file needs to contain the
          information      filename of the image file and either the height
                           or the width of the image.  Alchemy will make
                           assumptions about the other characteristics of the
                           image based on the information that it is given
                           and the total length of the image file.


          BIF file format  The first line contains the letters BIF, which
                           identifies the file as a BIF file.

                           Each of the rest of the lines in the BIF file
                           consist of an information tag followed by the
                           information.  The spelling of the tags must be
                           exact or Alchemy will report an unknown tag error.






















          192          Image Alchemy




          Tags

                      Tag  Description

                 filename  The name of the file containing the binary data.

                    width  The width of the image data, in pixels.

                   height  The height of the image data, in pixels.

                   planes  The number of planes of image data (1, 2, 3, or
                           4).
                           A 1 plane image is assumed to be gray-scale, a 2
                           plane image is a gray-scale image with an alpha
                           channel, a 3 plane image is a RGB image, and a 4
                           plane image is a RGB image with an alpha channel.

                   header  The size of the header, in bytes.  This many bytes
                           will be skipped when reading the file.

              leftpadding  The number of bytes to remove from the beginning
                           of each scan line.

             rightpadding  The number of bytes to remove from the end of each
                           scan line.

                    order  The order of the pixels.
                           For 3 channel images, this can be any sequence of
                           r, g, and b: rgb, rbg, grb, gbr, brg, or bgr
                           (r=red, g=green, b=blue).
                           For 4 channel images, this can be any sequence of
                           a, r, g, and b (a=alpha).
                           Either ga or ag for 2 channel images (g=gray,
                           a=alpha).

                           The defaults are g, ga, rgb, and rgba, depending
                           on the number of planes.

               upsidedown  The presence of this tag indicates that the data
                           in the file is recorded from the bottom of the
                           screen up to the top of the screen.



          Comments         Lines beginning with a # are treated as comments.
                           Comments and blank lines are ignored when
                           processing the file.







                                                   Image Alchemy          193




          Palette files    If the binary file has a palette available, you
                           can use that palette by writing custom software to
                           convert it to a .PAL file and using the -F option
                           while reading the BIF file.

          Example          This is an example BIF file which can be used to
                           read a 640 pixel wide, true colour HSI Raw file.
                           Note that HSI raw files have a 32 byte header
                           which is being skipped.  Of course you could read
                           the Raw file directly using Alchemy, but this is
                           after all an example of a BIF file.

                                BIF
                                width    640
                                #skip past header
                                header    32

                                filename  sample.raw
                                planes     3

                                #the tag below isn't actually needed,
                                #since rgb is the default, but is
                                #included here to give an example of
                                #what an order tag looks like

                                order   rgb

          Using the        Assuming the BIF file is called sample.bif, the
          example BIF      following Alchemy command can be used to convert
          file             the image to a GIF file:

                                alchemy sample.bif -g

                           The height of the image will be automatically
                           calculated from the length of the file and the
                           width, header, and planes tags.

                           A BIF file is treated as an ordinary file, so all
                           the standard Alchemy commands may be used.















          194          Image Alchemy




                                                                            F



          HSI Raw Files
          -------------------------------------------------------------------


          History          The HSI Raw format was originally intended as an
                           internal format to Image Alchemy.  Because of user
                           demand the format has been documented to allow
                           others to read and write HSI Raw files.

          Overview         HSI Raw files are completely uncompressed,
                           unpacked, and unpadded image data files.
                           Therefore they tend to be larger than almost any
                           compressed file format.  However, they have the
                           advantage, as far as Alchemy is concerned, that
                           they are very fast to read and write and the
                           location of any pixel in the image may be found by
                           simple calculations.

                           If you need to convert custom files to a format
                           that Alchemy can read we recommend using a Raw
                           file; it is the simplest format to write and the
                           fastest for Alchemy to read.

          Variations       There are two types of HSI Raw Files:  paletted
                           and true colour.  Paletted images are stored one
                           byte per pixel with a palette at the beginning of
                           the file.  True colour files are stored three
                           bytes per pixel.

               Gray-scale  Gray scale files are stored as paletted files with
                           a palette that contains all gray values.  Alchemy
                           automatically recognizes such files during reading
                           and will treat them appropriately.

          Black and white  Black and White files are stored as paletted files
                           with a palette that contains two values, black and
                           white.  Alchemy automatically recognizes such
                           files during reading and will treat them
                           appropriately.



          Warning          Note that Handmade Software, Inc. reserves the
                           right to make changes to this format at any time
                           and without notice.  And while it is unlikely, it
                           is possible that future versions of Image Alchemy
                           will not support this format.



                                                   Image Alchemy          195




          Old version      This appendix describes version 4 Raw files.  This
          files            is the version that Image Alchemy has written
                           since March 1991.  Before this Alchemy wrote
                           version 2 and 3 raw files (version 2 were 8 bit
                           files, version 3 were 24 bit files).  Those raw
                           files can be read by current versions of Image
                           Alchemy but are not otherwise supported.  If you
                           run across any of these raw files the easiest
                           thing to do is to use a current copy of Alchemy to
                           convert them to a version 4 raw file.



          Details

                Word size  All values which are not otherwise identified are
                           two byte integers (16 bits).  This is the native
                           integer size of most IBM PC C-compilers but not
                           for Macintosh and Sun C-compilers.


               Byte order  All integers are stored high byte first (big-
                           endian order).  This is the native mode for
                           Macintosh's and Sun's but not the native mode for
                           IBM PC's.


                           See below for a CPU independent method to read and
                           write 2-byte integers.

             Pixel format  Paletted files are stored one byte per pixel.

                           True colour files are stored as three bytes per
                           pixel in red, green, blue order.

                  Padding  Neither the palette information nor the pixel data
                           is padded to anything other than a byte boundary.
                           This means that if you store a file which is 13 by
                           11 pixels it will occupy 429 bytes if stored as a
                           true colour file (not including the header), or
                           143 bytes if stored as a paletted file (not
                           including the header and palette data).

                      Hex  Numbers including a 0x prefix are hex; all other
                           numbers are decimal.



          File format      The header for a paletted file is 32 bytes plus
                           the size of the palette.  The header for a true
                           colour file is exactly 32 bytes (a true colour
                           file contains no palette).


          196          Image Alchemy




             Magic number  Six bytes used to identify the file as a HSI Raw
                           file:

                                0x6d 0x68 0x77 0x61 0x6e 0x68

                  Version  An integer used to identify the version HSI file:

                                0x0004

                    Width  An integer indicating the width of the image (in
                           pixels).

                   Height  An integer indicating the height of the image (in
                           pixels).

             Palette size  An integer indicating the number of entries in the
                           palette.  Range is 2 to 256.  A 0  or -24
                           indicates a true colour image (which has no
                           palette data).

           Horizontal DPI  An integer indicating the horizontal resolution of
                           the image, in dots per inch.  A zero indicates
                           that the resolution is unknown.  A negative number
                           is used if only the aspect ratio is known.

             Vertical DPI  An integer indicating the vertical resolution of
                           the image, in dots per inch.  A zero indicates
                           that the resolution is unknown.  A negative number
                           is used if only the aspect ratio is known.

                    Gamma  An integer indicating the gamma of the image,
                           scaled by 100 (a gamma of 2.2 is stored as 220).
                           A zero indicates that the gamma is not known.

                 Reserved  Twelve bytes reserved for future use.  Should be
                           set to zero when writing.

                  Palette  The palette data is stored as 3 bytes per palette
                           entry.  The bytes are in red, green, blue order; 0
                           is black, 0xff is full intensity.

                           True colour raw files have no palette.

               Image data  The image data.



          Example files






                                                   Image Alchemy          197




          8 bit paletted,  6D 68 77 61 6E 68 00 04  01 40 00 C8 01 00 00 00
               320 x 200:  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00
                           49 24 24 24 00 00 00 00  00 DB 6D 6D FF 92 92 FF
                           B6 B6 92 49 49 FF DB DB  FF B6 92 FF FF DB FF DB
                           B6 FF FF FF B6 6D 6D 6D  24 24 DB 92 6D 6D 49 49
                           ...


              24 bit true  6D 68 77 61 6E 68 00 04  01 40 00 C8 00 00 00 00
                  colour,  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00
               320 x 200:  49 24 24 49 24 24 49 24  24 49 24 24 49 24 24 49
                           24 24 49 24 24 49 24 24  49 24 24 49 24 24 49 24
                           24 49 24 24 49 24 24 49  24 24 49 24 24 49 24 24
                           ...


          Reading a two
          byte integer
                                int getWord(int i, FILE *stream) {
                                   register int temp;
                                   temp=getc(stream)<<8;
                                   return(getc(stream) | temp);
                                }

          Writing a two
          byte integer
                                int putWord(int i, FILE *stream) {
                                   putc(i>>8, stream);
                                   return(putc(i&0xff, stream));
                                }
























          198          Image Alchemy




                                                                            G



          Undercolour Removal Files
          -------------------------------------------------------------------


          Summary          Undercolour removal files are text files which
                           control the conversion from RGB to CMYK colour
                           space.


                           This conversion consists of four steps.  The first
                           is to convert an RGB value to an ideal CMY value;
                           this simply involves negating the RGB values.  The
                           next step is to determine how much black is in
                           that colour; this is done by finding the minimum
                           of the CMY values and using that as an index into
                           the black removal tables documented below.  These
                           tables have independent values for how much black
                           to use for that pixel and how much black to
                           subtract from the CMY values.  Next, a linear
                           transform is optionally applied to the CMY portion
                           of the CMYK pixel.  Finally the CMYK values are
                           optionally translated, independently, through the
                           CMYK density correction tables (this last step is
                           only used if Alchemy is going to dither the image
                           for output on a 1 bit per pixel per component
                           device).

          File format      Any line beginning with ';' is a comment and is
                           ignored.


            Black removal  The first 256 non-comment lines contain
                   tables  undercolour removal values corresponding to
                           computed black values of 0 (white) to 255 (black).
                           Each of these lines has two numbers; the first
                           indicates how much black to use in place of the
                           computed black value corresponding to the line,
                           and the second indicates how much black to
                           subtract from the cyan, magenta, and yellow
                           components (this value must not be greater than
                           the corresponding computed black value).


                           After the black removal block the remaining blocks
                           may appear in any order.





                                                   Image Alchemy          199




               CMY linear  If there is a line which says only "HSI CMY
                transform  matrix" then the next 3 non-comment lines contain
                           a matrix representing a linear transform which is
                           applied to the cyan, magenta, and yellow
                           components after black removal and before applying
                           the density map.  The entries are normalized
                           around 256.  The first row and column represent
                           cyan, the second magenta, and the third yellow.
                           The rows are multiplied by the input cyan,
                           magenta, and yellow values to create the corrected
                           values.  A matrix of

                                256   0   0
                                  0 256   0
                                  0   0 256


                           is equivalent to omitting the matrix and causes no
                           correction to take place.  In this case it would
                           be preferable to omit the matrix as the conversion
                           will run slightly faster without it.


             CMYK density  If there is a line which says only "HSI CMYK
               correction  density map" then the next 256 non-comment lines
                   tables  contain density correction tables, corresponding
                           to cyan, magenta, yellow, and black values of 0
                           (white) to 255.  Each of these lines has four
                           numbers representing, in order, the amount of
                           cyan, magenta, yellow, and black to use in place
                           of the corresponding computed values.  These
                           tables are only applied during dithering; they
                           will not be used for those CMYK output formats
                           which are continuous tone, as devices which take
                           continuous tone input data should be doing their
                           own correction.

          Example          The following undercolour removal file has
                           undercolour removal tables, CMYK density
                           correction tables, and a CMY colour correction
                           matrix.


                                ; Undercolour removal file
                                ;
                                  0   0
                                  1   1
                                  1   1
                                  2   2
                                  3   3
                                ... (256 entries total)
                                169 169


          200          Image Alchemy




                                169 169
                                170 170
                                ;
                                HSI CMY matrix
                                ;the following matrix leaves the
                                ; Cyan and Yellow planes alone, and
                                ; subtracts a bit from the Magenta
                                ; plane when there's Cyan present.
                                ;
                                256   0   0
                                -32 256   0
                                  0   0 256
                                ;
                                HSI CMYK density map
                                ;
                                  0   0   0   0
                                  0   0   0   0
                                  0   0   0   0
                                  0   0   0   0
                                ... (256 entries total)
                                246 246 246 246
                                248 248 248 248
                                251 251 251 251
                                253 253 253 253
                                255 255 255 255





























                                                   Image Alchemy          201




                                                                            H



          PAL Files
          -------------------------------------------------------------------


          Overview         PAL files are text files which contain a palette
                           in an ASCII form.  Alchemy can extract palettes
                           from other file formats and write PAL files.
                           Alchemy can also use PAL files when converting
                           images.

          File format      The first line contains the letters "PAL"; this
                           identifies the file as a palette file.

                           The next line contains an integer indicating the
                           number of palette entries.  Valid values are 2
                           through 256.

                           The rest of the file consists of lines of 3
                           numbers each (separated by spaces) representing
                           the red, green, and blue values for each of the
                           colours.  These have a range of 0 (black) to 255
                           (full intensity).

          Example
                                PAL
                                8            ;# colours
                                  0   0   0  ;black
                                255   0   0  ;bright red
                                  0 128   0  ;dark green
                                255 255   0  ;yellow
                                  0   0 255  ;blue
                                255   0 255  ;magenta
                                 63  63  63  ;gray
                                255 255 255  ;white
















          202          Image Alchemy




                                                                            I



          Acknowledgments
          -------------------------------------------------------------------


          Summary          Almost all the software which comprises Image
                           Alchemy was written in house.  However the TIFF
                           and 640x400 SVGA display modules are modifications
                           of software originally written by other people.

                           Both of these modules are free for anyone's use as
                           long as proper credit is given as to the origin of
                           the software.


                     TIFF  Image Alchemy's TIFF I/O is based on libtiff which
                           is copyright by Sam Leffler and is used with his
                           permission.  If you are interested in reading or
                           writing TIFF files we strongly suggest that you
                           start with libtiff.

                           Libtiff is available by anonymous ftp as
                           ucbvax.berkeley.edu:pub/tiff/*.tar.Z or
                           uunet.uu.net:graphics/tiff.tar.Z.

                           If you cannot get a copy of libtiff via anonymous
                           ftp please contact us for a free copy.


              VGA display  Image Alchemy's 640x400 SVGA display routines are
                           based on VGAKIT, written by John Bridges.

                           VGAKIT is available free of charge from a variety
                           of bulletin boards

                           If you cannot find VGAKIT locally please contact
                           us for a free copy.














                                                   Image Alchemy          203




                                                                            J



          Other Useful Software
          -------------------------------------------------------------------


          Summary          There are several image processing packages
                           available for little or no cost.

                           Please be aware that we mention these software
                           packages only as a service to Image Alchemy users.
                           We are not endorsing or recommending any
                           particular package.  Many of the packages are not
                           supported by their authors.

                           If you have trouble finding any of the listed
                           software please send us a blank tape or diskette
                           and we will send you a copy free of charge (please
                           be aware that the software may be quite large;
                           contact us first if you have any questions).

                           If you know of any other software which would be
                           appropriate to add to this list please let us
                           know.

                           If you are the author of any of these packages and
                           you would rather not be on this list please let us
                           know.
























          204          Image Alchemy




          IBM PC

                   PicLab  A public-domain image file conversion and printing
                           tool.
                           Written by Lee Crocker and the Stone Soup Group.
                           Available via CompuServe.


                    Cshow  A shareware image viewing program.
                           Written by Bob Berry.
                           Available from:
                              Canyon State Systems and Software
                              PO Box 86
                              Sedona, AZ  86336


                    Vivid  A shareware ray-tracing program.
                           Written by Stephen B. Coy
                           Available from:
                              Stephen Coy
                              15205 NE 13th Pl., #2904
                              Bellevue, WA  98007



          Workstations     These programs are only available as source code
                           and generally require a workstation running UNIX
                           or one of its variants.


              Utah Raster  Written by Spencer W. Thomas, Rod G. Bogart, and
            Toolkit (URT)  James Painter.
                           Available via anonymous FTP as pub/urt-3.0.tar.Z
                           via anonymous ftp from cs.utah.edu,
                           weedeater.math.yale.edu, or
                           freebie.engin.umich.edu.




             Fuzzy Bitmap  Written by Michael Mauldin
             Manipulation  Available by anonymous ftp as
                    (FBM)  nl.cs.cmu.edu:/usr/mlm/ftp/fbm.tar.Z,
                           uunet.uu.net:pub/fbm.tar.Z, or
                           ucsd.edu:graphics/fbm.tar.Z.


          Portable BitMap  Written by Jef Poskanzer
                (PBMPLUS)  Available by anonymous ftp as
                           expo.lcs.mit.edu:contrib/pbmplus.tar.Z or
                           ftp.ee.lbl.gov:pbmplus.tar.Z.



                                                   Image Alchemy          205





             Img Software  Written by Paul Raveling
                      Set  Available by anonymous ftp as
                           expo.lcs.mit.edu:contrib/img_1.3.tar.Z or
                           venera.isi.edu:pub/img_1.3.tar.Z.

















































          206          Image Alchemy








          Glossary
          -------------------------------------------------------------------


            Anonymous FTP  An easy way to transfer files via the Internet.
                           If you don't have Internet access you can't use
                           anonymous FTP; if you do have Internet access you
                           probably already know about it (if you don't, ask
                           your system administrator or local network guru).

          Black and white  An image which contains just two colours, black
                           and white.  Many file formats, such as TIFF and
                           Sun Raster, have special variations for black and
                           white images.  You can force Alchemy to write a
                           black and white image by specifying -b -c2 as
                           options.

                Dithering  A technique for reducing the amount of colour
                           banding in an image when converting from a large
                           number of different colours to a small number of
                           different colours.  Different dithering techniques
                           are usually named after the person or persons who
                           first invented them.  Alchemy supports Floyd-
                           Steinberg, Stucki, and JJN dithering; these are
                           further described in "Digital Halftoning", by
                           Robert Ulichney, MIT Press.

               Gray-scale  An image which contains just shades of gray.  Many
                           file formats, such as TIFF and Silicon Graphics,
                           have special variations for gray-scale images.
                           You can force Alchemy to write a gray-scale image
                           by specifying -b -8 as options.

                   Header  The portion of an image file that is not the
                           actual image data.  The data in a header generally
                           includes the image size (in pixels), the image
                           depth (in number of bits per pixel or number of
                           colours), and the palette (if the image has a
                           palette).  Some file formats include quite a bit
                           of additional data in the header, such as:  the
                           name of the image, the date and time the image was
                           created, and the latitude and longitude of the
                           image (primarily used by satellite image data).
                           The header is called the header because it usually
                           appears at the head of the file.  Some file
                           formats store information which is usually found
                           in the header in a separate file.



                                                   Image Alchemy          207




          Heckbert colour  A technique for reducing the number of colours
             quantization  needed by an image, typically used to convert a
                           true colour image to a paletted image.  Named
                           after Paul Heckbert who originally described the
                           technique in "Color Image Quantization for Frame
                           Buffer Display", SIGGRAPH '82 Proceedings, p. 297.

             Magic Number  A number or sequence of numbers that is found at
                           or near the start of an image file so that
                           software may determine what type of format the
                           file is.  Most formats have a well defined magic
                           number; some formats do not, in which case Alchemy
                           examines various parameters in the header of the
                           file and guesses what format the image is.

                 Paletted  An image which isn't true colour.  Each pixel in
                           the image is an index into a table of values
                           (typically red, green, and blue) which describe
                           the colour of that pixel.  Most paletted images
                           are limited to 8 bits of information, which allows
                           256 unique colours.  Most display adapters only
                           allow the display of paletted images (Alchemy can
                           display true colour images on those display
                           adapters by using a uniform palette).

              True colour  An image which does not contain a palette.  Each
                           pixel in the image is represented by at least
                           three values, typically red, green, and blue.
                           True colour images are generally produced by
                           scanners and digitizers and are better quality and
                           much larger than paletted images.  Most display
                           systems cannot display true colour images.






















          208          Image Alchemy








          References
          -------------------------------------------------------------------


          General          Computer Graphics - Principles and Practice,
          Computer         Second Edition
          Graphics         (Commonly referred to as Foley and van Dam)
                           J.D. Foley, A. van Dam, S.K. Feiner, and J.F.
                           Hughes
                           Addison-Wesley
                           ISBN 0-201-12110-7


                           Principles of Interactive Computer Graphics
                           (Commonly referred to as Newman and Sproull)
                           W.M. Newman and R.F. Sproull
                           McGraw-Hill
                           ISBN 0-07-046338-7


                           Algorithms for Graphics and Image Processing
                           Theo Pavlidis
                           Computer Science Press
                           ISBN 0-914894-65-X


                           Graphics Gems
                           Andrew S. Glassner
                           Academic Press
                           ISBN 0-12-286165-5


                           Graphics Gems II
                           James Arvo
                           Academic Press
                           ISBN 0-12-064480-0


                           Bit-Mapped Graphics
                           Steve Rimmer
                           Windcrest
                           ISBN 0-8306-3558-0








                                                   Image Alchemy          209


          Specific Topics

                   Colour  The Reproduction of Colour in Photography,
                           Printing & Television
                           R.W.G. Hunt
                           Fountain Press
                           ISBN 0 85242 356 X


                Dithering  Digital Halftoning
                           Robert Ulichney
                           MIT Press.
                           ISBN 0-262-21009-6


            Image Scaling  Digital Image Warping
                           George Wolberg
                           IEEE Computer Society Press Monograph
                           ISBN 0-8186-8944-7


          VGA Programming  Programmer's Guide to the EGA and VGA Cards,
                           Second Edition
                           Richard F. Ferraro
                           Addison-Wesley
                           ISBN 0-201-57025-4






























          210          Image Alchemy
